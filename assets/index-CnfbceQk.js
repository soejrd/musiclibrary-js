(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(n){if(n.ep)return;n.ep=!0;const t=r(n);fetch(n.href,t)}})();let c=[],y=[];async function ne(){try{const e=await fetch("library_full.json");if(!e.ok)throw new Error("Failed to load album data from library_full.json");return c=await e.json(),console.log("Loaded library:",c.length,"albums"),y=c,c}catch(e){return console.error("Error loading album data:",e),c=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",c.length,"albums"),y=c,c}}function X(e){if(!e){y=c;return}const o=e.toLowerCase();y=c.filter(r=>{const s=r.album.toLowerCase(),n=r.artist.toLowerCase();return s.includes(o)||n.includes(o)||s.includes(o.slice(0,-1))||n.includes(o.slice(0,-1))||o.length>1&&(s.includes(o.slice(1))||n.includes(o.slice(1)))})}function F(){return y}function w(){return y.length}function K(){for(let e=c.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[c[e],c[o]]=[c[o],c[e]]}y===c&&(y=c)}let I=null,k=null,A=3;const oe=1,se=5;let T=0,P=0,Z=176,C=176,G=0,O=0,J="grid";function ie(){if(I=document.querySelector("main"),k=document.querySelector("#grid"),!I||!k){console.error("Grid container or grid element not found");return}B(),h(0)}function B(){if(!I)return;const o={1:8,2:7,3:5,4:4,5:2}[A],r=I.offsetWidth;C=Math.floor((r-(o-1)*16)/o),Z=C}function h(e){!I||!k||(O=e,T=Math.floor(I.offsetWidth/C),P=Math.ceil(O/T),G=P*C,k.style.height=`${G}px`)}function re(){return A<se?(A++,!0):!1}function le(){return A>oe?(A--,!0):!1}function V(){return{columns:T,rowHeight:Z,itemWidth:C,totalAlbums:O}}function x(){return k}function ae(e){J=e}function f(){return J}function Q({img:e,album:o,artist:r,link:s}){const n=document.createElement("a");n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("href",s||"#"),n.className="album-card relative overflow-hidden flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20";const t=document.getElementById("grid");return t&&t.style.display==="flex"&&t.style.overflowX==="auto"?n.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-auto object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${o||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="text-container mt-2 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-xl font-bold text-zinc-100 mb-1 truncate">${o||"Unknown Album"}</h3>
          <p class="text-base text-zinc-300 truncate">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `:n.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${o||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1 truncate">${o||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 truncate mb-1">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `,n}const E=new Set;function ce(){const{rowHeight:e,columns:o,totalAlbums:r}=V(),s=3,n=window.scrollY,t=window.innerHeight,i=Math.floor(n/e)-s,u=Math.ceil((n+t)/e)+s,a=Math.max(0,i),m=Math.min(Math.ceil(r/o),u),d=a*o,l=Math.min(r,m*o);return{startIndex:d,endIndex:l}}function M(){const e=x();if(!e)return;const{startIndex:o,endIndex:r}=ce(),{columns:s,rowHeight:n,itemWidth:t}=V(),i=F(),u=new Set;for(let a=o;a<r;a++)if(u.add(a),!E.has(a)){const m=i[a],d=Q({img:m?.img,album:m?.album,artist:m?.artist,link:m?.link}),l=Math.floor(a/s),p=a%s;d.style.position="absolute",d.style.top=`${l*n}px`,d.style.left=`${p*t}px`,d.style.width=`${t}px`,d.style.height=`${n}px`,d.dataset.index=a.toString(),e.appendChild(d),E.add(a)}E.forEach(a=>{if(!u.has(a)){const m=e.querySelector(`[data-index='${a}']`);m&&e.removeChild(m),E.delete(a)}})}function R(){const e=x();if(!e)return;const{columns:o,rowHeight:r,itemWidth:s}=V();E.forEach(n=>{const t=e.querySelector(`[data-index='${n}']`);if(t){const i=Math.floor(n/o),u=n%o;t.style.top=`${i*r}px`,t.style.left=`${u*s}px`,t.style.width=`${s}px`,t.style.height=`${r}px`}})}function de(){const e=x();e&&(e.innerHTML="",E.clear())}const j=1e3,N=-75,H=new Set;function ue(){const e=x();if(!e)return;const o=F(),r=o.length;e.style.height="auto",e.style.overflowX="auto",e.style.overflowY="hidden",e.style.whiteSpace="nowrap",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="flex-start",e.style.scrollSnapType="x mandatory";for(let s=0;s<r;s++)if(!H.has(s)){const n=o[s],t=Q({img:n?.img,album:n?.album,artist:n?.artist,link:n?.link});t.classList.add("coverflow-item"),t.classList.add("w-sm"),t.style.position="relative",t.style.display="inline-block",t.style.scrollSnapAlign="center",t.style.flexShrink="0",t.dataset.index=s.toString(),e.appendChild(t),H.add(s)}}function fe(e){if(!x())return;F().length}function me(){const e=x();e&&(e.innerHTML="",H.clear(),e.style.overflowX="",e.style.overflowY="",e.style.whiteSpace="",e.style.display="",e.style.alignItems="",e.style.justifyContent="",e.style.scrollSnapType="")}function U(){const e=x();if(!e)return;const o=window.innerWidth,r=e.scrollLeft,s=o/2+r,n=e.querySelectorAll(".coverflow-item"),t=8;let i=-1,u=1/0;n.forEach(d=>{const l=d,p=d.getBoundingClientRect(),b=p.left+p.width/2+r,L=Math.abs(s-b);L<u?(u=L,i=parseInt(l.dataset.index||"0",10),l.classList.add("center-album")):l.classList.remove("center-album");const g=l.querySelector(".text-container");if(g){const z=o/8,v=Math.max(0,1-L/z);v>0?(g.classList.remove("opacity-0"),g.style.opacity=v.toString()):(g.classList.add("opacity-0"),g.style.opacity="0")}}),fe();const a=Math.max(0,i-t),m=i+t;n.forEach(d=>{const l=d,p=parseInt(l.dataset.index||"0",10),b=d.getBoundingClientRect(),L=b.left+b.width/2+r,g=Math.abs(s-L);if(l.style.transform="none",l.style.opacity="0.5",l.style.marginLeft=`${N}px`,l.style.marginRight=`${N}px`,p>=a&&p<=m){const z=o/2,v=Math.min(g/z,1),W=30+v*30,_=1-v*.4,D=1-v*.7,ee=Math.floor(100-v*50);l.style.zIndex=ee.toString();let q=W;if(g<b.width/2){const te=g/(b.width/2);q=W*te}g<b.width/2&&g<10?(l.style.transform=`perspective(${j}px) scale(1)`,l.style.opacity="1"):L<s?(l.style.transform=`perspective(${j}px) rotateY(${q}deg) scale(${D})`,l.style.opacity=_.toString()):(l.style.transform=`perspective(${j}px) rotateY(-${q}deg) scale(${D})`,l.style.opacity=_.toString())}})}function Y(e,o){let r=null;return function(...s){r!==null&&clearTimeout(r),r=setTimeout(()=>e.apply(this,s),o)}}function S(){const e=f();e==="grid"?M():e==="coverflow"&&ue()}function $(){const e=f();e==="grid"?de():e==="coverflow"&&me()}function ge(){document.getElementById("viewToggleBtn")?.addEventListener("click",()=>{const t=f()==="grid"?"coverflow":"grid";ae(t);const i=document.querySelector("#viewToggleBtn .material-symbols-rounded");i&&(i.textContent=t==="grid"?"view_carousel":"grid_view"),$(),t==="grid"&&h(w()),S(),t==="coverflow"&&U()});const e=document.getElementById("grid"),o=document.querySelector(".scrim");e&&o&&(e.addEventListener("mouseover",n=>{const t=n.target;if(f()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){o.classList.remove("opacity-0"),o.classList.add("opacity-70");const i=t.classList.contains("album-card")?t:t.closest(".album-card");i&&i.classList.add("z-50")}}),e.addEventListener("mouseout",n=>{const t=n.target;if(f()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){o.classList.remove("opacity-70"),o.classList.add("opacity-0");const i=t.classList.contains("album-card")?t:t.closest(".album-card");i&&i.classList.remove("z-50")}})),document.getElementById("zoomInBtn")?.addEventListener("click",()=>{f()==="grid"&&re()&&(B(),h(w()),R(),M())}),document.getElementById("zoomOutBtn")?.addEventListener("click",()=>{f()==="grid"&&le()&&(B(),h(w()),R(),M())}),document.getElementById("shuffleBtn")?.addEventListener("click",()=>{K(),$(),S()}),window.addEventListener("resize",Y(()=>{f()==="grid"&&(B(),h(w()),R(),M())},200));let r=!1;window.addEventListener("scroll",()=>{f()==="grid"&&!r&&(requestAnimationFrame(()=>{M(),r=!1}),r=!0)});let s=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{f()==="coverflow"&&!s&&(requestAnimationFrame(()=>{U(),s=!1}),s=!0)}),document.getElementById("searchInput")?.addEventListener("input",Y(n=>{const t=n.target;X(t.value),$(),f()==="grid"&&h(w()),S();const i=document.querySelector(".arrow-back"),u=t;t.value.length>0?(i?.classList.remove("invisible","-translate-x-2"),i?.classList.add("visible","translate-x-0"),u.classList.remove("-translate-x-9")):(i?.classList.remove("visible","translate-x-0"),i?.classList.add("invisible","-translate-x-2"),u.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const n=document.getElementById("searchInput");if(n){n.value="",X(""),$(),f()==="grid"&&h(w()),S();const t=document.querySelector(".arrow-back");t?.classList.remove("visible","translate-x-0"),t?.classList.add("invisible","-translate-x-2"),n.classList.add("-translate-x-9")}}),document.getElementById("themeBtn")?.addEventListener("click",()=>{const n=document.documentElement,t=document.querySelector("#themeBtn .material-symbols-rounded");n.classList.contains("dark")?(n.classList.remove("dark"),t&&(t.textContent="dark_mode"),localStorage.setItem("theme","light")):(n.classList.add("dark"),t&&(t.textContent="light_mode"),localStorage.setItem("theme","dark"))}),document.addEventListener("DOMContentLoaded",()=>{const n=localStorage.getItem("theme"),t=document.documentElement,i=document.querySelector("#themeBtn .material-symbols-rounded");n==="light"?(t.classList.add("light"),i&&(i.textContent="light_mode")):(t.classList.remove("light"),i&&(i.textContent="dark_mode"))})}function he(){document.addEventListener("DOMContentLoaded",async()=>{ie(),await ne(),K(),h(w()),S(),ge()})}he();
