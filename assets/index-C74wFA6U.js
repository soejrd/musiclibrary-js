(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();let u=[],v=[];async function it(){try{const t=await fetch("library_full.json");if(!t.ok)throw new Error("Failed to load album data from library_full.json");return u=await t.json(),console.log("Loaded library:",u.length,"albums"),v=u,u}catch(t){return console.error("Error loading album data:",t),u=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",u.length,"albums"),v=u,u}}function F(t){if(!t){v=u;return}const n=t.toLowerCase();v=u.filter(i=>{const l=i.album.toLowerCase(),e=i.artist.toLowerCase();return l.includes(n)||e.includes(n)||l.includes(n.slice(0,-1))||e.includes(n.slice(0,-1))||n.length>1&&(l.includes(n.slice(1))||e.includes(n.slice(1)))})}function J(){return v}function L(){return v.length}function Q(){for(let t=u.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[u[t],u[n]]=[u[n],u[t]]}v===u&&(v=u)}let S=null,M=null,z=3;const rt=1,at=5;let _=0,U=0,tt=176,A=176,G=0,H=0,et="grid";function ct(){if(S=document.querySelector("main"),M=document.querySelector("#grid"),!S||!M){console.error("Grid container or grid element not found");return}q(),b(0)}function q(){if(!S)return;const n={1:8,2:7,3:5,4:4,5:2}[z],i=S.offsetWidth;A=Math.floor((i-(n-1)*16)/n),tt=A}function b(t){!S||!M||(H=t,_=Math.floor(S.offsetWidth/A),U=Math.ceil(H/_),G=U*A,M.style.height=`${G}px`)}function dt(){return z<at?(z++,!0):!1}function ut(){return z>rt?(z--,!0):!1}function N(){return{columns:_,rowHeight:tt,itemWidth:A,totalAlbums:H}}function k(){return M}function ft(t){et=t}function m(){return et}function ot({img:t,album:n,artist:i,link:l}){const e=document.createElement("a");e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("href",l||"#"),e.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20";const o=document.getElementById("grid");return o&&o.style.display==="flex"&&o.style.overflowX==="auto"?e.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${t||""}" alt="${n||"Album"}">
          <img class="album-image--shadow w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${t||""}" alt="${n||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${n||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${i||"Unknown Artist"}</p>
        </div>
      </div>
    `:e.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${t||""}" alt="${n||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1 truncate">${n||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 truncate mb-1">${i||"Unknown Artist"}</p>
        </div>
      </div>
    `,e}const I=new Set;function mt(){const{rowHeight:t,columns:n,totalAlbums:i}=N(),l=3,e=window.scrollY,o=window.innerHeight,s=Math.floor(e/t)-l,a=Math.ceil((e+o)/t)+l,r=Math.max(0,s),d=Math.min(Math.ceil(i/n),a),f=r*n,h=Math.min(i,d*n);return{startIndex:f,endIndex:h}}function C(){const t=k();if(!t)return;t.classList.add("py-5"),t.classList.remove("coverflow-mode");const{startIndex:n,endIndex:i}=mt(),{columns:l,rowHeight:e,itemWidth:o}=N(),s=J(),a=new Set;for(let r=n;r<i;r++)if(a.add(r),!I.has(r)){const d=s[r],f=ot({img:d?.img,album:d?.album,artist:d?.artist,link:d?.link}),h=Math.floor(r/l),E=r%l;f.style.position="absolute",f.style.top=`${h*e}px`,f.style.left=`${E*o}px`,f.style.width=`${o}px`,f.style.height=`${e}px`,f.dataset.index=r.toString(),t.appendChild(f),I.add(r)}I.forEach(r=>{if(!a.has(r)){const d=t.querySelector(`[data-index='${r}']`);d&&t.removeChild(d),I.delete(r)}})}function V(){const t=k();if(!t)return;const{columns:n,rowHeight:i,itemWidth:l}=N();I.forEach(e=>{const o=t.querySelector(`[data-index='${e}']`);if(o){const s=Math.floor(e/n),a=e%n;o.style.top=`${s*i}px`,o.style.left=`${a*l}px`,o.style.width=`${l}px`,o.style.height=`${i}px`}})}function pt(){const t=k();t&&(t.innerHTML="",I.clear())}const R=1e3,Y=-85,W=new Set,ht=new Map,gt=16;let K=0;function yt(){const t=k();if(!t)return;const n=J(),i=n.length;t.style.height="auto",t.style.overflowX="auto",t.style.overflowY="visible",t.style.whiteSpace="nowrap",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="flex-start",t.style.scrollSnapType="x mandatory",t.classList.add("py-40"),t.classList.add("coverflow-mode");let l=t.parentElement?.querySelector(".scroll-indicator");if(!l){l=document.createElement("div"),l.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),l.style.height="30px";for(let e=0;e<80;e++){const o=document.createElement("div");o.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),o.dataset.index=e.toString(),l.appendChild(o)}t.parentElement&&t.parentElement.insertBefore(l,t)}for(let e=0;e<i;e++)if(!W.has(e)){const o=n[e],s=ot({img:o?.img,album:o?.album,artist:o?.artist,link:o?.link});s.classList.add("coverflow-item"),s.classList.add("w-sm"),s.style.position="relative",s.style.display="inline-block",s.style.scrollSnapAlign="center",s.style.flexShrink="0",s.dataset.index=e.toString(),t.appendChild(s),W.add(e)}if(i>5){const e=t.querySelector('[data-index="4"]');e&&e.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}}function bt(){const t=k();if(!t)return;t.innerHTML="",W.clear(),t.classList.remove("coverflow-mode");const n=t.parentElement?.querySelector(".scroll-indicator");n&&n.remove(),t.style.overflowX="",t.style.overflowY="",t.style.whiteSpace="",t.style.display="",t.style.alignItems="",t.style.justifyContent="",t.style.scrollSnapType=""}function nt(){const t=performance.now();if(t-K<gt)return;K=t;const n=k();if(!n)return;const i=window.innerWidth,l=n.scrollLeft,e=i/2+l,o=n.querySelectorAll(".coverflow-item"),s=8;let a=-1,r=1/0;const d=[];o.forEach(f=>{const h=f,E=parseInt(h.dataset.index||"0",10),c=f.getBoundingClientRect(),g=c.left+c.width/2+l,w=Math.abs(e-g);ht.set(E,{rect:c,centerX:g,distance:w}),d.push({element:h,rect:c,centerX:g,distance:w,index:E}),w<r&&(r=w,a=parseInt(h.dataset.index||"0",10))}),requestAnimationFrame(()=>{const f=n.parentElement?.querySelector(".scroll-indicator");if(f){o.length;const c=l/(n.scrollWidth-i),g=Math.floor(c*99);f.querySelectorAll(".indicator-line").forEach((y,B)=>{const p=y;B===g?(p.style.transform="scale(2.5, 2.5)",p.style.opacity="1"):(p.style.transform="scale(1, 1)",p.style.opacity="0.3")})}const h=Math.max(0,a-s),E=a+s;d.forEach(({element:c,rect:g,centerX:w,distance:y})=>{const B=parseInt(c.dataset.index||"0",10);if(c.style.transform="none",c.style.opacity="0.5",c.style.marginLeft=`${Y}px`,c.style.marginRight=`${Y}px`,B>=h&&B<=E){const j=i/2,x=Math.min(y/j,1),X=30+x*30,D=1-x*.4,P=1-x*.7,st=Math.floor(100-x*50);c.style.zIndex=st.toString();let O=X;if(y<g.width/2){const lt=y/(g.width/2);O=X*lt}y<g.width/2&&y<20?(c.style.transform=`perspective(${R}px) scale(1)`,c.style.opacity="1"):w<e?(c.style.transform=`perspective(${R}px) rotateY(${O}deg) scale(${P})`,c.style.opacity=D.toString()):(c.style.transform=`perspective(${R}px) rotateY(-${O}deg) scale(${P})`,c.style.opacity=D.toString())}const p=c.querySelector(".text-container");if(p){const j=i/8,x=Math.max(0,1-y/j);x>0?(p.classList.remove("opacity-0"),p.style.opacity=x.toString()):(p.classList.add("opacity-0"),p.style.opacity="0")}})})}function vt(){const t=document.getElementById("controlsContainer");if(!t)return;[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{Q(),T(),$()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{m()==="grid"&&ut()&&(q(),b(L()),V(),C())}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{m()==="grid"&&dt()&&(q(),b(L()),V(),C())}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const s=m()==="grid"?"coverflow":"grid";ft(s);const a=document.querySelector("#viewToggleBtn .material-symbols-rounded");a&&(a.textContent=s==="grid"?"view_carousel":"grid_view");const r=document.getElementById("zoomInBtn"),d=document.getElementById("zoomOutBtn");r&&d&&(s==="coverflow"?(r.classList.add("w-0","opacity-0","-translate-x-full","collapse"),d.classList.add("w-0","opacity-0","translate-x-full","collapse"),r.classList.remove("px-2"),d.classList.remove("px-2")):(r.classList.remove("w-0","opacity-0","-translate-x-full","collapse"),d.classList.remove("w-0","opacity-0","translate-x-full","collapse"),r.classList.add("px-2"),d.classList.add("px-2"))),T(),s==="grid"&&b(L()),$(),s==="coverflow"&&nt()}},{id:"themeBtn",icon:"light_mode",handler:()=>{const o=document.documentElement,s=document.querySelector("#themeBtn .material-symbols-rounded");o.classList.contains("dark")?(o.classList.remove("dark"),s&&(s.textContent="dark_mode"),localStorage.setItem("theme","light")):(o.classList.add("dark"),s&&(s.textContent="light_mode"),localStorage.setItem("theme","dark"))}}].forEach(o=>{const s=document.createElement("button");s.id=o.id,s.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-150 ease-out"+(o.className?` ${o.className}`:"");const a=document.createElement("span");a.className="material-symbols-rounded",a.textContent=o.icon,s.appendChild(a),o.handler&&s.addEventListener("click",o.handler),t.appendChild(s)});const i=localStorage.getItem("theme"),l=document.documentElement,e=document.querySelector("#themeBtn .material-symbols-rounded");i==="light"?(l.classList.remove("dark"),e&&(e.textContent="dark_mode")):(l.classList.add("dark"),e&&(e.textContent="light_mode"))}function Z(t,n){let i=null;return function(...l){i!==null&&clearTimeout(i),i=setTimeout(()=>t.apply(this,l),n)}}function $(){const t=m();t==="grid"?C():t==="coverflow"&&yt()}function T(){const t=m();t==="grid"?pt():t==="coverflow"&&bt()}function wt(){const t=document.getElementById("grid"),n=document.querySelector(".scrim");t&&n&&(t.addEventListener("mouseover",e=>{const o=e.target;if(m()==="grid"&&(o.classList.contains("album-card")||o.closest(".album-card"))){n.classList.remove("opacity-0"),n.classList.add("opacity-70");const s=o.classList.contains("album-card")?o:o.closest(".album-card");s&&s.classList.add("z-50")}}),t.addEventListener("mouseout",e=>{const o=e.target;if(m()==="grid"&&(o.classList.contains("album-card")||o.closest(".album-card"))){n.classList.remove("opacity-70"),n.classList.add("opacity-0");const s=o.classList.contains("album-card")?o:o.closest(".album-card");s&&s.classList.remove("z-50")}})),window.addEventListener("resize",Z(()=>{m()==="grid"&&(q(),b(L()),V(),C())},200));let i=!1;window.addEventListener("scroll",()=>{m()==="grid"&&!i&&(requestAnimationFrame(()=>{C(),i=!1}),i=!0)});let l=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{m()==="coverflow"&&!l&&(requestAnimationFrame(()=>{nt(),l=!1}),l=!0)}),document.getElementById("searchInput")?.addEventListener("input",Z(e=>{const o=e.target;F(o.value),T(),m()==="grid"&&b(L()),$();const s=document.querySelector(".arrow-back"),a=o;o.value.length>0?(s?.classList.remove("invisible","-translate-x-2"),s?.classList.add("visible","translate-x-0"),a.classList.remove("-translate-x-9")):(s?.classList.remove("visible","translate-x-0"),s?.classList.add("invisible","-translate-x-2"),a.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const e=document.getElementById("searchInput");if(e){e.value="",F(""),T(),m()==="grid"&&b(L()),$();const o=document.querySelector(".arrow-back");o?.classList.remove("visible","translate-x-0"),o?.classList.add("invisible","-translate-x-2"),e.classList.add("-translate-x-9")}})}function xt(){document.addEventListener("DOMContentLoaded",async()=>{ct(),await it(),Q(),b(L()),$(),vt(),wt()})}xt();
