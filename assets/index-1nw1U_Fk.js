(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function ut(){const t=document.createElement("header"),e="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-300 ease-out";t.className="px-2 inset-x-0 top-8 h-[54px] flex items-center justify-between fixed z-1000 max-w-2xl mx-auto",t.dataset.state="regular",t.innerHTML=`
      <div class="flex flex-row w-full h-full items-center justify-between dark:bg-zinc-900/80 bg-zinc-300/80 backdrop-blur-sm dark:shadow-md rounded-full border-1 dark:border-gray-100/10 border-gray-400/10 bg-zinc-100/10 transition-all duration-300 ease-out dark:hover:bg-zinc-800/80 dark:hover:border-gray-100/20">
        <button></button>
        <span
          class="material-symbols-rounded dark:hover:text-zinc-100 text-zinc-400 hover:text-zinc-950 transition-all duration-300 ease-out cursor-pointer ml-4 arrow-back transition-transform duration-300 ease-out invisible -translate-x-2"
          >close</span
        >
        <input
          type="text"
          placeholder="Zoek naar artiest/album..."
          id="searchInput"
          class="flex-1 w-full px-4 py-2 dark:text-gray-100 text-black dark:focus:text-white focus:outline-none -translate-x-9 transition-transform duration-300 ease-out block"
          data-state="visible"
        />
        <div class="settings flex flex-row md:invisible border-l-1 dark:border-zinc-800 border-zinc-400/30 mr-2 pl-2 h-full items-center justify-center">
          <button id="settingsBtn" class="${e}">
            <span class="material-symbols-rounded">tune</span>
          </button>
        </div>
        <div
          class="controls h-full hidden md:flex flex-row items-center absolute left-0 md:relative md:justify-center md:border-l-1 border-l-0 dark:border-zinc-800 border-zinc-400/30 mr-2 pl-2 translate-x-4 md:translate-x-0 transition-all duration-300 ease-out opacity-0 md:opacity-100 will-change-transform,opacity"
          id="controlsContainer"
          data-state="hidden"
        >
          <button id="shuffleBtn" class="${e} controls--shuffle">
            <span class="material-symbols-rounded">shuffle</span>
          </button>
          <button id="zoomOutBtn" class="${e}">
            <span class="material-symbols-rounded">zoom_out</span>
          </button>
          <button id="zoomInBtn" class="${e}">
            <span class="material-symbols-rounded">zoom_in</span>
          </button>
          <button id="viewToggleBtn" class="${e}">
            <span class="material-symbols-rounded">view_carousel</span>
          </button>
          <button id="themeBtn" class="${e}">
            <span class="material-symbols-rounded">light_mode</span>
          </button>
        </div>
      </div>
    `;const n=t.querySelector("#settingsBtn"),s=t.querySelector("#searchInput"),o=t.querySelector("#controlsContainer");let r;return n?.addEventListener("click",()=>{clearTimeout(r),t.dataset.state==="regular"?(t.dataset.state="settings",s?.classList.add("hidden"),o?.classList.remove("hidden"),o?.classList.add("flex","opacity-0","translate-x-4"),o&&o.offsetWidth,o?.classList.remove("translate-x-4","opacity-0"),o?.setAttribute("data-state","visible")):(t.dataset.state="regular",s?.classList.remove("hidden"),o?.classList.add("translate-x-4","opacity-0"),r=window.setTimeout(()=>{o?.classList.add("hidden"),o?.classList.remove("flex")},300),o?.setAttribute("data-state","hidden"))}),t}let d=[],w=[];async function ft(){try{const t=await fetch("library_full.json");if(!t.ok)throw new Error("Failed to load album data from library_full.json");return d=await t.json(),console.log("Loaded library:",d.length,"albums"),w=d,d}catch(t){return console.error("Error loading album data:",t),d=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",d.length,"albums"),w=d,d}}function mt(t){if(!t){w=d;return}const e=t.toLowerCase();w=d.filter(n=>{const s=n.album.toLowerCase(),o=n.artist.toLowerCase();return s.includes(e)||o.includes(e)||s.includes(e.slice(0,-1))||o.includes(e.slice(0,-1))||e.length>1&&(s.includes(e.slice(1))||o.includes(e.slice(1)))})}function K(){return w}function P(){return w.length}function et(){for(let t=d.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[d[t],d[e]]=[d[e],d[t]]}w===d&&(w=d)}function nt({img:t,album:e,artist:n,link:s}){const o=document.createElement("a");return o.setAttribute("target","_blank"),o.setAttribute("rel","noopener noreferrer"),o.setAttribute("href",s||"#"),o.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20",p()=="coverflow"?o.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${t||""}" alt="${e||"Album"}">
          <img class="album-image--shadow group-hover:opacity-12 group-hover:blur-[64px] w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${t||""}" alt="${e||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${e||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${n||"Unknown Artist"}</p>
        </div>
      </div>
    `:o.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0 flex justify-center items-center">
          <img class="w-full object-cover text-xs text-zinc-300 text-center" loading="lazy" src="${t||""}" alt="${e||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1 animate-pulse"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1">${e||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 mb-1">${n||"Unknown Artist"}</p>
        </div>
      </div>
    `,o}const j=1e3,B=-100,ot=80,I=new Set,ht=16;let J=0;function pt(){const t=x();if(!t)return;const e=K(),n=e.length,s=Math.min(n,20),o=document.createElement("div");o.style.width=`${n*150}px`,o.style.height="1px",t.appendChild(o);let r=t.parentElement?.querySelector(".scroll-indicator");if(!r){r=document.createElement("div"),r.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),r.style.height="30px";for(let i=0;i<ot;i++){const a=document.createElement("div");a.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),a.dataset.index=i.toString(),r.appendChild(a)}t.parentElement&&t.parentElement.insertBefore(r,t),r.addEventListener("click",i=>gt(i,t,n))}for(let i=0;i<s;i++){const a=e[i],l=st(a,i);t.appendChild(l),I.add(i)}if(n>5){const i=t.querySelector('[data-index="4"]');i&&i.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}T()}function bt(){const t=x();if(t){for(;t.firstChild;)t.removeChild(t.firstChild);I.clear()}}function st(t,e){const n=nt({img:t?.img,album:t?.album,artist:t?.artist,link:t?.link});n.classList.add("coverflow-item","w-sm"),n.style.position="absolute",n.style.display="inline-block",n.style.scrollSnapAlign="center",n.style.flexShrink="0",n.dataset.index=e.toString();const s=150;return n.style.left=`${e*s}px`,n}function T(){const t=performance.now();if(t-J<ht)return;J=t;const e=x();if(!e)return;const n=K(),s=n.length,o=window.innerWidth,r=e.scrollLeft,i=o/2+r,a=10,l=150,f=Math.floor(r/l),h=Math.max(0,f-a),b=Math.min(s-1,f+a),L=new Set;for(let c=h;c<=b;c++)L.add(c);I.forEach(c=>{if(!L.has(c)){const g=e.querySelector(`[data-index="${c}"]`);g&&e.removeChild(g),I.delete(c)}}),L.forEach(c=>{if(!I.has(c)){const g=n[c],m=st(g,c);e.appendChild(m),I.add(c)}});const O=e.querySelectorAll(".coverflow-item");requestAnimationFrame(()=>{const c=e.parentElement?.querySelector(".scroll-indicator");if(c){const g=s*l,m=r/(g-o),E=Math.floor(m*(ot-1));c.querySelectorAll(".indicator-line").forEach((y,D)=>{const v=y;D===E?(v.style.transform="scale(2.5, 2.5)",v.style.opacity="1"):(v.style.transform="scale(1, 1)",v.style.opacity="0.3")})}O.forEach(g=>{const m=g;parseInt(m.dataset.index||"0",10);const E=m.getBoundingClientRect(),W=E.left+E.width/2+r,y=Math.abs(i-W);m.style.transform="none",m.style.opacity="1",m.style.marginLeft=`${B}px`,m.style.marginRight=`${B}px`;const D=o/2,v=Math.min(y/D,1),X=30+v*30,Z=1-v*.7,dt=Math.floor(100-v*50);m.style.zIndex=dt.toString();let q=X;if(y<E.width/2){const G=y/(E.width/2);q=X*G}y<E.width/2&&y<20?m.style.transform=`perspective(${j}px) scale(1)`:W<i?m.style.transform=`perspective(${j}px) rotateY(${q}deg) scale(${Z})`:m.style.transform=`perspective(${j}px) rotateY(-${q}deg) scale(${Z})`;const C=m.querySelector(".text-container");if(C){const G=o/16,Y=Math.max(0,1-y/G);Y>0?(C.classList.remove("opacity-0"),C.style.opacity=Y.toString()):(C.classList.add("opacity-0"),C.style.opacity="0")}})})}function gt(t,e,n){const o=window.innerWidth,r=t.currentTarget.getBoundingClientRect(),a=(t.clientX-r.left)/r.width,l=n*(150+Math.abs(B)),f=a*(l-o),h=Math.floor((f+o/2)/(150+Math.abs(B))),b=e.querySelector(`[data-index="${h}"]`);if(b){const L=b.offsetLeft,O=b.offsetWidth,c=L-o/2+O/2;e.scrollTo({left:c,behavior:"smooth"})}else e.scrollTo({left:f,behavior:"smooth"})}let z=null,S=null,M=3;const yt=1,vt=5;let F=0,Q=0,rt=176,R=176,tt=0,H=0,it="grid";function wt(){if(z=document.querySelector("main"),S=document.querySelector("#grid"),!z||!S){console.error("Grid container or grid element not found");return}lt(),$(0)}function lt(){if(!z)return;const e={1:8,2:7,3:5,4:4,5:2}[M],n=z.offsetWidth;R=Math.floor((n-(e-1)*16)/e),rt=R}function $(t){!z||!S||(H=t,F=Math.floor(z.offsetWidth/R),Q=Math.ceil(H/F),tt=Q*R,S.style.height=`${tt}px`)}function xt(){return M<vt?(M++,!0):!1}function Lt(){return M>yt?(M--,!0):!1}function N(){return{columns:F,rowHeight:rt,itemWidth:R,totalAlbums:H}}function x(){return S}function Et(t){const e=["coverflow-mode","py-40","overflow-x-auto","scroll-smooth","overflow-y-visible","whitespace-nowrap","flex","items-center","justify-start","snap-x","snap-mandatory"],n=["grid-mode","mt-30"],s=x();if(s)if(it=t,t==="grid"){const o=s.parentElement?.querySelector(".scroll-indicator");o&&o.remove(),s.classList.remove(...e),s.classList.add(...n)}else s.classList.remove(...n),s.classList.add(...e),T(),s.style.height="100vh"}function p(){return it}const k=new Set;function It(){const{rowHeight:t,columns:e,totalAlbums:n}=N(),s=3,o=window.scrollY,r=window.innerHeight,i=Math.floor(o/t)-s,a=Math.ceil((o+r)/t)+s,l=Math.max(0,i),f=Math.min(Math.ceil(n/e),a),h=l*e,b=Math.min(n,f*e);return{startIndex:h,endIndex:b}}function U(){const t=x();if(!t)return;const{startIndex:e,endIndex:n}=It(),{columns:s,rowHeight:o,itemWidth:r}=N(),i=K(),a=new Set;for(let l=e;l<n;l++)if(a.add(l),!k.has(l)){const f=i[l],h=nt({img:f?.img,album:f?.album,artist:f?.artist,link:f?.link}),b=Math.floor(l/s),L=l%s;h.style.position="absolute",h.style.top=`${b*o}px`,h.style.left=`${L*r}px`,h.style.width=`${r}px`,h.style.height=`${o}px`,h.dataset.index=l.toString(),t.appendChild(h),k.add(l)}k.forEach(l=>{if(!a.has(l)){const f=t.querySelector(`[data-index='${l}']`);f&&t.removeChild(f),k.delete(l)}})}function kt(){const t=x();if(!t)return;const{columns:e,rowHeight:n,itemWidth:s}=N();k.forEach(o=>{const r=t.querySelector(`[data-index='${o}']`);if(r){const i=Math.floor(o/e),a=o%e;r.style.top=`${i*n}px`,r.style.left=`${a*s}px`,r.style.width=`${s}px`,r.style.height=`${n}px`}})}function At(){Dt(k)}const A={LIGHT:"light",DARK:"dark"},u={GRID:"grid",COVERFLOW:"coverflow"};function at(t,e){let n=null;return function(...s){n!==null&&clearTimeout(n),n=setTimeout(()=>t.apply(this,s),e)}}function ct(){const t=p();t===u.GRID?U():t===u.COVERFLOW&&pt()}function zt(){const t=p();t===u.GRID?At():t===u.COVERFLOW&&bt()}function V(){zt(),p()===u.GRID&&$(P()),ct()}function _(){p()===u.GRID&&(lt(),$(P()),kt(),U())}function Ct(){const t=document.documentElement,e=document.querySelector("#themeBtn .material-symbols-rounded"),n=t.classList.toggle(A.DARK),s=n?A.DARK:A.LIGHT;e&&(e.textContent=n?"light_mode":"dark_mode"),localStorage.setItem("theme",s)}function St(){const t=localStorage.getItem("theme"),e=document.documentElement,n=document.querySelector("#themeBtn .material-symbols-rounded");t===A.LIGHT?(e.classList.remove(A.DARK),n&&(n.textContent="dark_mode")):(e.classList.add(A.DARK),n&&(n.textContent="light_mode"))}function Mt(t){const e=document.getElementById("zoomInBtn"),n=document.getElementById("zoomOutBtn");if(!e||!n)return;const s=t===u.COVERFLOW,o=s?["w-0","opacity-0","collapse"]:["px-2"],r=s?["px-2"]:["w-0","opacity-0","collapse"];e.classList.add(...o),e.classList.remove(...r),n.classList.add(...o),n.classList.remove(...r),s?(e.classList.add("-translate-x-full"),n.classList.add("translate-x-full")):(e.classList.remove("-translate-x-full"),n.classList.remove("translate-x-full"))}function Rt(t){const e=document.getElementById("searchInput"),n=document.querySelector(".arrow-back");!e||!n||(t?(n.classList.remove("invisible","-translate-x-2"),n.classList.add("visible","translate-x-0"),e.classList.remove("-translate-x-9")):(n.classList.remove("visible","translate-x-0"),n.classList.add("invisible","-translate-x-2"),e.classList.add("-translate-x-9")))}function Bt(){const t=document.getElementById("grid"),e=document.querySelector(".scrim");if(!t||!e)return;const n=(s,o)=>{const i=s.target.closest(".album-card");p()===u.GRID&&i&&(e.classList.toggle("opacity-0",!o),e.classList.toggle("opacity-70",o),i.classList.toggle("z-50",o))};t.addEventListener("mouseover",s=>n(s,!0)),t.addEventListener("mouseout",s=>n(s,!1))}function Tt(){let t=!1;window.addEventListener("scroll",()=>{p()===u.GRID&&!t&&(window.requestAnimationFrame(()=>{U(),t=!1}),t=!0)});let e=!1;x()?.addEventListener("scroll",()=>{p()===u.COVERFLOW&&!e&&(window.requestAnimationFrame(()=>{T(),e=!1}),e=!0)})}function $t(){const t=document.getElementById("searchInput");if(!t)return;const e=at(n=>{mt(n),V(),Rt(n.length>0)},200);t.addEventListener("input",n=>{e(n.target.value)}),document.querySelector(".arrow-back")?.addEventListener("click",()=>{t.value="",e("")}),window.addEventListener("keydown",n=>{const s=document.activeElement,o=s===t,r=s&&["INPUT","TEXTAREA","SELECT"].includes(s.tagName)&&!o;if(n.ctrlKey||n.altKey||n.metaKey||r)return;const i=n.key.length===1,a=n.key==="Backspace";!o&&(i||a)&&(n.preventDefault(),t.focus(),a?t.value=t.value.slice(0,-1):t.value+=n.key,e(t.value))})}function Ot(){document.getElementById("shuffleBtn")?.addEventListener("click",()=>{et(),V()}),document.getElementById("zoomOutBtn")?.addEventListener("click",()=>{p()===u.GRID&&Lt()&&_()}),document.getElementById("zoomInBtn")?.addEventListener("click",()=>{p()===u.GRID&&xt()&&_()}),document.getElementById("viewToggleBtn")?.addEventListener("click",()=>{const e=p()===u.GRID?u.COVERFLOW:u.GRID;Et(e);const n=document.querySelector("#viewToggleBtn .material-symbols-rounded");n&&(n.textContent=e===u.GRID?"view_carousel":"grid_view"),Mt(e),V(),e===u.COVERFLOW&&T()}),document.getElementById("themeBtn")?.addEventListener("click",Ct)}function Wt(){Bt(),window.addEventListener("resize",at(_,200)),Tt(),$t(),Ot()}function Dt(t){const e=x();if(!e)return;Array.from(e.children).forEach(s=>{s.style.height!=="1px"&&e.removeChild(s)}),p()!=="coverflow"&&(e.innerHTML=""),t.clear()}async function qt(){wt(),await ft(),et(),$(P()),ct(),Wt(),St()}document.addEventListener("DOMContentLoaded",async()=>{const t=document.getElementById("app");t&&t.prepend(ut()),await qt()});
