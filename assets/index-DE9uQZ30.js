(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(t){if(t.ep)return;t.ep=!0;const e=r(t);fetch(t.href,e)}})();let u=[],y=[];async function rt(){try{const o=await fetch("library_full.json");if(!o.ok)throw new Error("Failed to load album data from library_full.json");return u=await o.json(),console.log("Loaded library:",u.length,"albums"),y=u,u}catch(o){return console.error("Error loading album data:",o),u=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",u.length,"albums"),y=u,u}}function F(o){if(!o){y=u;return}const n=o.toLowerCase();y=u.filter(r=>{const i=r.album.toLowerCase(),t=r.artist.toLowerCase();return i.includes(n)||t.includes(n)||i.includes(n.slice(0,-1))||t.includes(n.slice(0,-1))||n.length>1&&(i.includes(n.slice(1))||t.includes(n.slice(1)))})}function J(){return y}function x(){return y.length}function Q(){for(let o=u.length-1;o>0;o--){const n=Math.floor(Math.random()*(o+1));[u[o],u[n]]=[u[n],u[o]]}y===u&&(y=u)}function tt({img:o,album:n,artist:r,link:i}){const t=document.createElement("a");return t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("href",i||"#"),t.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20",m()=="coverflow"?t.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${o||""}" alt="${n||"Album"}">
          <img class="album-image--shadow group-hover:opacity-12 group-hover:blur-[64px] w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${o||""}" alt="${n||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${n||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `:t.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${o||""}" alt="${n||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1 truncate">${n||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 truncate mb-1">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `,t}const R=1e3,U=-100,_=new Set,lt=new Map,at=16;let X=0;function ct(){const o=k();if(!o)return;const n=J(),r=n.length;let i=o.parentElement?.querySelector(".scroll-indicator");if(!i){i=document.createElement("div"),i.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),i.style.height="30px";for(let t=0;t<80;t++){const e=document.createElement("div");e.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),e.dataset.index=t.toString(),i.appendChild(e)}o.parentElement&&o.parentElement.insertBefore(i,o)}for(let t=0;t<r;t++)if(!_.has(t)){const e=n[t],s=tt({img:e?.img,album:e?.album,artist:e?.artist,link:e?.link});s.classList.add("coverflow-item"),s.classList.add("w-sm"),s.style.position="relative",s.style.display="inline-block",s.style.scrollSnapAlign="center",s.style.flexShrink="0",s.dataset.index=t.toString(),o.appendChild(s),_.add(t)}if(r>5){const t=o.querySelector('[data-index="4"]');t&&t.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}}function dt(){nt(_)}function N(){const o=performance.now();if(o-X<at)return;X=o;const n=k();if(!n)return;const r=window.innerWidth,i=n.scrollLeft,t=r/2+i,e=n.querySelectorAll(".coverflow-item"),s=5;let a=-1,l=1/0;const c=[];e.forEach(f=>{const h=f,L=parseInt(h.dataset.index||"0",10),d=f.getBoundingClientRect(),g=d.left+d.width/2+i,w=Math.abs(t-g);lt.set(L,{rect:d,centerX:g,distance:w}),c.push({element:h,rect:d,centerX:g,distance:w,index:L}),w<l&&(l=w,a=parseInt(h.dataset.index||"0",10))}),requestAnimationFrame(()=>{const f=n.parentElement?.querySelector(".scroll-indicator");if(f){e.length;const d=i/(n.scrollWidth-r),g=Math.floor(d*99);f.querySelectorAll(".indicator-line").forEach((b,B)=>{const p=b;B===g?(p.style.transform="scale(2.5, 2.5)",p.style.opacity="1"):(p.style.transform="scale(1, 1)",p.style.opacity="0.3")})}const h=Math.max(0,a-s),L=a+s;c.forEach(({element:d,rect:g,centerX:w,distance:b})=>{const B=parseInt(d.dataset.index||"0",10);if(d.style.transform="none",d.style.opacity="1",d.style.marginLeft=`${U}px`,d.style.marginRight=`${U}px`,B>=h&&B<=L){const T=r/2,E=Math.min(b/T,1),P=30+E*30,G=1-E*.7,st=Math.floor(100-E*50);d.style.zIndex=st.toString();let O=P;if(b<g.width/2){const it=b/(g.width/2);O=P*it}b<g.width/2&&b<20?d.style.transform=`perspective(${R}px) scale(1)`:w<t?d.style.transform=`perspective(${R}px) rotateY(${O}deg) scale(${G})`:d.style.transform=`perspective(${R}px) rotateY(-${O}deg) scale(${G})`}const p=d.querySelector(".text-container");if(p){const T=r/8,E=Math.max(0,1-b/T);E>0?(p.classList.remove("opacity-0"),p.style.opacity=E.toString()):(p.classList.add("opacity-0"),p.style.opacity="0")}})})}let M=null,z=null,S=3;const ut=1,ft=5;let H=0,K=0,et=176,A=176,Y=0,W=0,ot="grid";function mt(){if(M=document.querySelector("main"),z=document.querySelector("#grid"),!M||!z){console.error("Grid container or grid element not found");return}q(),v(0)}function q(){if(!M)return;const n={1:8,2:7,3:5,4:4,5:2}[S],r=M.offsetWidth;A=Math.floor((r-(n-1)*16)/n),et=A}function v(o){!M||!z||(W=o,H=Math.floor(M.offsetWidth/A),K=Math.ceil(W/H),Y=K*A,z.style.height=`${Y}px`)}function pt(){return S<ft?(S++,!0):!1}function ht(){return S>ut?(S--,!0):!1}function D(){return{columns:H,rowHeight:et,itemWidth:A,totalAlbums:W}}function k(){return z}function gt(o){let n=["coverflow-mode","py-40","h-auto","overflow-x-auto","overflow-y-visible","whitespace-nowrap","flex","items-center","justify-start","snap-x","snap-mandatory"],r=["grid-mode","mt-30"];const i=k();if(i)if(ot=o,o==="grid"){const t=i.parentElement?.querySelector(".scroll-indicator");t&&t.remove(),i.classList.remove(...n),i.classList.add(...r)}else i.classList.remove(...r),i.classList.add(...n),N(),i.style.height="auto"}function m(){return ot}const I=new Set;function bt(){const{rowHeight:o,columns:n,totalAlbums:r}=D(),i=3,t=window.scrollY,e=window.innerHeight,s=Math.floor(t/o)-i,a=Math.ceil((t+e)/o)+i,l=Math.max(0,s),c=Math.min(Math.ceil(r/n),a),f=l*n,h=Math.min(r,c*n);return{startIndex:f,endIndex:h}}function $(){const o=k();if(!o)return;const{startIndex:n,endIndex:r}=bt(),{columns:i,rowHeight:t,itemWidth:e}=D(),s=J(),a=new Set;for(let l=n;l<r;l++)if(a.add(l),!I.has(l)){const c=s[l],f=tt({img:c?.img,album:c?.album,artist:c?.artist,link:c?.link}),h=Math.floor(l/i),L=l%i;f.style.position="absolute",f.style.top=`${h*t}px`,f.style.left=`${L*e}px`,f.style.width=`${e}px`,f.style.height=`${t}px`,f.dataset.index=l.toString(),o.appendChild(f),I.add(l)}I.forEach(l=>{if(!a.has(l)){const c=o.querySelector(`[data-index='${l}']`);c&&o.removeChild(c),I.delete(l)}})}function V(){const o=k();if(!o)return;const{columns:n,rowHeight:r,itemWidth:i}=D();I.forEach(t=>{const e=o.querySelector(`[data-index='${t}']`);if(e){const s=Math.floor(t/n),a=t%n;e.style.top=`${s*r}px`,e.style.left=`${a*i}px`,e.style.width=`${i}px`,e.style.height=`${r}px`}})}function vt(){nt(I)}function yt(){const o=document.getElementById("controlsContainer");if(!o)return;[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{Q(),j(),C()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{m()==="grid"&&ht()&&(q(),v(x()),V(),$())}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{m()==="grid"&&pt()&&(q(),v(x()),V(),$())}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const s=m()==="grid"?"coverflow":"grid";gt(s);const a=document.querySelector("#viewToggleBtn .material-symbols-rounded");a&&(a.textContent=s==="grid"?"view_carousel":"grid_view");const l=document.getElementById("zoomInBtn"),c=document.getElementById("zoomOutBtn");l&&c&&(s==="coverflow"?(l.classList.add("w-0","opacity-0","-translate-x-full","collapse"),c.classList.add("w-0","opacity-0","translate-x-full","collapse"),l.classList.remove("px-2"),c.classList.remove("px-2")):(l.classList.remove("w-0","opacity-0","-translate-x-full","collapse"),c.classList.remove("w-0","opacity-0","translate-x-full","collapse"),l.classList.add("px-2"),c.classList.add("px-2"))),j(),s==="grid"&&v(x()),C(),s==="coverflow"&&N()}},{id:"themeBtn",icon:"light_mode",handler:()=>{const e=document.documentElement,s=document.querySelector("#themeBtn .material-symbols-rounded");e.classList.contains("dark")?(e.classList.remove("dark"),s&&(s.textContent="dark_mode"),localStorage.setItem("theme","light")):(e.classList.add("dark"),s&&(s.textContent="light_mode"),localStorage.setItem("theme","dark"))}}].forEach(e=>{const s=document.createElement("button");s.id=e.id,s.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-150 ease-out"+(e.className?` ${e.className}`:"");const a=document.createElement("span");a.className="material-symbols-rounded",a.textContent=e.icon,s.appendChild(a),e.handler&&s.addEventListener("click",e.handler),o.appendChild(s)});const r=localStorage.getItem("theme"),i=document.documentElement,t=document.querySelector("#themeBtn .material-symbols-rounded");r==="light"?(i.classList.remove("dark"),t&&(t.textContent="dark_mode")):(i.classList.add("dark"),t&&(t.textContent="light_mode"))}function Z(o,n){let r=null;return function(...i){r!==null&&clearTimeout(r),r=setTimeout(()=>o.apply(this,i),n)}}function C(){const o=m();o==="grid"?$():o==="coverflow"&&ct()}function j(){const o=m();o==="grid"?vt():o==="coverflow"&&dt()}function wt(){const o=document.getElementById("grid"),n=document.querySelector(".scrim");o&&n&&(o.addEventListener("mouseover",t=>{const e=t.target;if(m()==="grid"&&(e.classList.contains("album-card")||e.closest(".album-card"))){n.classList.remove("opacity-0"),n.classList.add("opacity-70");const s=e.classList.contains("album-card")?e:e.closest(".album-card");s&&s.classList.add("z-50")}}),o.addEventListener("mouseout",t=>{const e=t.target;if(m()==="grid"&&(e.classList.contains("album-card")||e.closest(".album-card"))){n.classList.remove("opacity-70"),n.classList.add("opacity-0");const s=e.classList.contains("album-card")?e:e.closest(".album-card");s&&s.classList.remove("z-50")}})),window.addEventListener("resize",Z(()=>{m()==="grid"&&(q(),v(x()),V(),$())},200));let r=!1;window.addEventListener("scroll",()=>{m()==="grid"&&!r&&(requestAnimationFrame(()=>{$(),r=!1}),r=!0)});let i=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{m()==="coverflow"&&!i&&(requestAnimationFrame(()=>{N(),i=!1}),i=!0)}),document.getElementById("searchInput")?.addEventListener("input",Z(t=>{const e=t.target;F(e.value),j(),m()==="grid"&&v(x()),C();const s=document.querySelector(".arrow-back"),a=e;e.value.length>0?(s?.classList.remove("invisible","-translate-x-2"),s?.classList.add("visible","translate-x-0"),a.classList.remove("-translate-x-9")):(s?.classList.remove("visible","translate-x-0"),s?.classList.add("invisible","-translate-x-2"),a.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const t=document.getElementById("searchInput");if(t){t.value="",F(""),j(),m()==="grid"&&v(x()),C();const e=document.querySelector(".arrow-back");e?.classList.remove("visible","translate-x-0"),e?.classList.add("invisible","-translate-x-2"),t.classList.add("-translate-x-9")}})}function nt(o){const n=k();n&&(n.innerHTML="",o.clear())}function xt(){document.addEventListener("DOMContentLoaded",async()=>{mt(),await rt(),Q(),v(x()),C(),yt(),wt()})}xt();
