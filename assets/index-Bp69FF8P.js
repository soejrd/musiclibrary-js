(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();let i=[],m=[];async function R(){try{const t=await fetch("library_full.json");if(!t.ok)throw new Error("Failed to load album data from library_full.json");return i=await t.json(),console.log("Loaded library:",i.length,"albums"),m=i,i}catch(t){return console.error("Error loading album data:",t),i=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",i.length,"albums"),m=i,i}}function z(t){if(!t){m=i;return}const o=t.toLowerCase();m=i.filter(s=>{const r=s.album.toLowerCase(),e=s.artist.toLowerCase();return r.includes(o)||e.includes(o)||r.includes(o.slice(0,-1))||e.includes(o.slice(0,-1))||o.length>1&&(r.includes(o.slice(1))||e.includes(o.slice(1)))})}function H(){return m}function b(){return m.length}function q(){for(let t=i.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[i[t],i[o]]=[i[o],i[t]]}m===i&&(m=i)}let p=null,y=null,v=3;const N=1,W=5;let k=0,B=0,j=176,L=176,C=0,M=0;function T(){if(p=document.querySelector("main"),y=document.querySelector("#grid"),!p||!y){console.error("Grid container or grid element not found");return}w(),f(0)}function w(){if(!p)return;const o={1:8,2:7,3:5,4:4,5:2}[v],s=p.offsetWidth;L=Math.floor((s-(o-1)*16)/o),j=L}function f(t){!p||!y||(M=t,k=Math.floor(p.offsetWidth/L),B=Math.ceil(M/k),C=B*L,y.style.height=`${C}px`)}function _(){return v<W?(v++,!0):!1}function P(){return v>N?(v--,!0):!1}function S(){return{columns:k,rowHeight:j,itemWidth:L,totalAlbums:M}}function A(){return y}function D({img:t,album:o,artist:s,link:r}){const e=document.createElement("a");return e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("href",r||"#"),e.className="album-card relative overflow-hidden flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20",e.innerHTML=`
    <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
      <div class="album-image w-full h-full object-cover flex-shrink-0">
        <img class="w-full object-cover" loading="lazy" src="${t||""}" alt="${o||"Album"}">
        <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
      </div>
      <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
      <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
        <h3 class="font-bold text-zinc-100 mb-1 truncate">${o||"Unknown Album"}</h3>
        <p class="text-xs text-zinc-300 truncate mb-1">${s||"Unknown Artist"}</p>
      </div>
    </div>
  `,e}const g=new Set;function F(){const{rowHeight:t,columns:o,totalAlbums:s}=S(),r=3,e=window.scrollY,n=window.innerHeight,a=Math.floor(e/t)-r,h=Math.ceil((e+n)/t)+r,l=Math.max(0,a),c=Math.min(Math.ceil(s/o),h),d=l*o,x=Math.min(s,c*o);return{startIndex:d,endIndex:x}}function u(){const t=A();if(!t)return;const{startIndex:o,endIndex:s}=F(),{columns:r,rowHeight:e,itemWidth:n}=S(),a=H(),h=new Set;for(let l=o;l<s;l++)if(h.add(l),!g.has(l)){const c=a[l],d=D({img:c?.img,album:c?.album,artist:c?.artist,link:c?.link}),x=Math.floor(l/r),O=l%r;d.style.position="absolute",d.style.top=`${x*e}px`,d.style.left=`${O*n}px`,d.style.width=`${n}px`,d.style.height=`${e}px`,d.dataset.index=l.toString(),t.appendChild(d),g.add(l)}g.forEach(l=>{if(!h.has(l)){const c=t.querySelector(`[data-index='${l}']`);c&&t.removeChild(c),g.delete(l)}})}function E(){const t=A();if(!t)return;const{columns:o,rowHeight:s,itemWidth:r}=S();g.forEach(e=>{const n=t.querySelector(`[data-index='${e}']`);if(n){const a=Math.floor(e/o),h=e%o;n.style.top=`${a*s}px`,n.style.left=`${h*r}px`,n.style.width=`${r}px`,n.style.height=`${s}px`}})}function I(){const t=A();t&&(t.innerHTML="",g.clear())}function $(t,o){let s=null;return function(...r){s!==null&&clearTimeout(s),s=setTimeout(()=>t.apply(this,r),o)}}function G(){const t=document.getElementById("grid"),o=document.querySelector(".scrim");t&&o&&(t.addEventListener("mouseover",r=>{const e=r.target;if(e.classList.contains("album-card")||e.closest(".album-card")){o.classList.remove("opacity-0"),o.classList.add("opacity-70");const n=e.classList.contains("album-card")?e:e.closest(".album-card");n&&n.classList.add("z-50")}}),t.addEventListener("mouseout",r=>{const e=r.target;if(e.classList.contains("album-card")||e.closest(".album-card")){o.classList.remove("opacity-70"),o.classList.add("opacity-0");const n=e.classList.contains("album-card")?e:e.closest(".album-card");n&&n.classList.remove("z-50")}})),document.getElementById("zoomInBtn")?.addEventListener("click",()=>{_()&&(w(),f(b()),E(),u())}),document.getElementById("zoomOutBtn")?.addEventListener("click",()=>{P()&&(w(),f(b()),E(),u())}),document.getElementById("shuffleBtn")?.addEventListener("click",()=>{q(),I(),u()}),window.addEventListener("resize",$(()=>{w(),f(b()),E(),u()},200));let s=!1;window.addEventListener("scroll",()=>{s||(requestAnimationFrame(()=>{u(),s=!1}),s=!0)}),document.getElementById("searchInput")?.addEventListener("input",$(r=>{const e=r.target;z(e.value),I(),f(b()),u();const n=document.querySelector(".arrow-back"),a=e;e.value.length>0?(n?.classList.remove("invisible","-translate-x-2"),n?.classList.add("visible","translate-x-0"),a.classList.remove("-translate-x-9")):(n?.classList.remove("visible","translate-x-0"),n?.classList.add("invisible","-translate-x-2"),a.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const r=document.getElementById("searchInput");if(r){r.value="",z(""),I(),f(b()),u();const e=document.querySelector(".arrow-back");e?.classList.remove("visible","translate-x-0"),e?.classList.add("invisible","-translate-x-2"),r.classList.add("-translate-x-9")}}),document.getElementById("themeBtn")?.addEventListener("click",()=>{const r=document.documentElement,e=document.querySelector("#themeBtn .material-symbols-rounded");r.classList.contains("dark")?(r.classList.remove("dark"),e&&(e.textContent="dark_mode"),localStorage.setItem("theme","light")):(r.classList.add("dark"),e&&(e.textContent="light_mode"),localStorage.setItem("theme","dark"))}),document.addEventListener("DOMContentLoaded",()=>{const r=localStorage.getItem("theme"),e=document.documentElement,n=document.querySelector("#themeBtn .material-symbols-rounded");r==="light"?(e.classList.add("light"),n&&(n.textContent="light_mode")):(e.classList.remove("light"),n&&(n.textContent="dark_mode"))})}function U(){document.addEventListener("DOMContentLoaded",async()=>{T(),await R(),q(),f(b()),u(),G()})}U();
