(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const l of t.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?t.credentials="include":n.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(n){if(n.ep)return;n.ep=!0;const t=r(n);fetch(n.href,t)}})();let u=[],v=[];async function le(){try{const e=await fetch("library_full.json");if(!e.ok)throw new Error("Failed to load album data from library_full.json");return u=await e.json(),console.log("Loaded library:",u.length,"albums"),v=u,u}catch(e){return console.error("Error loading album data:",e),u=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",u.length,"albums"),v=u,u}}function X(e){if(!e){v=u;return}const o=e.toLowerCase();v=u.filter(r=>{const s=r.album.toLowerCase(),n=r.artist.toLowerCase();return s.includes(o)||n.includes(o)||s.includes(o.slice(0,-1))||n.includes(o.slice(0,-1))||o.length>1&&(s.includes(o.slice(1))||n.includes(o.slice(1)))})}function F(){return v}function x(){return v.length}function Z(){for(let e=u.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[u[e],u[o]]=[u[o],u[e]]}v===u&&(v=u)}let S=null,C=null,k=3;const se=1,re=5;let T=0,G=0,J=176,A=176,Y=0,_=0,Q="grid";function ie(){if(S=document.querySelector("main"),C=document.querySelector("#grid"),!S||!C){console.error("Grid container or grid element not found");return}q(),b(0)}function q(){if(!S)return;const o={1:8,2:7,3:5,4:4,5:2}[k],r=S.offsetWidth;A=Math.floor((r-(o-1)*16)/o),J=A}function b(e){!S||!C||(_=e,T=Math.floor(S.offsetWidth/A),G=Math.ceil(_/T),Y=G*A,C.style.height=`${Y}px`)}function ae(){return k<re?(k++,!0):!1}function ce(){return k>se?(k--,!0):!1}function W(){return{columns:T,rowHeight:J,itemWidth:A,totalAlbums:_}}function L(){return C}function de(e){Q=e}function m(){return Q}function ee({img:e,album:o,artist:r,link:s}){const n=document.createElement("a");n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("href",s||"#"),n.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20";const t=document.getElementById("grid");return t&&t.style.display==="flex"&&t.style.overflowX==="auto"?n.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:shadow-md transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${o||"Album"}">
          <img class="album-image--shadow w-full object-cover absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${e||""}" alt="${o||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold text-zinc-100 mb-2 truncate">${o||"Unknown Album"}</h3>
          <p class="text-lg text-zinc-300 truncate">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `:n.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${o||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1 truncate">${o||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 truncate mb-1">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `,n}const I=new Set;function ue(){const{rowHeight:e,columns:o,totalAlbums:r}=W(),s=3,n=window.scrollY,t=window.innerHeight,l=Math.floor(n/e)-s,a=Math.ceil((n+t)/e)+s,c=Math.max(0,l),f=Math.min(Math.ceil(r/o),a),h=c*o,M=Math.min(r,f*o);return{startIndex:h,endIndex:M}}function $(){const e=L();if(!e)return;e.classList.add("py-5"),e.classList.remove("coverflow-mode");const{startIndex:o,endIndex:r}=ue(),{columns:s,rowHeight:n,itemWidth:t}=W(),l=F(),a=new Set;for(let c=o;c<r;c++)if(a.add(c),!I.has(c)){const f=l[c],h=ee({img:f?.img,album:f?.album,artist:f?.artist,link:f?.link}),M=Math.floor(c/s),g=c%s;h.style.position="absolute",h.style.top=`${M*n}px`,h.style.left=`${g*t}px`,h.style.width=`${t}px`,h.style.height=`${n}px`,h.dataset.index=c.toString(),e.appendChild(h),I.add(c)}I.forEach(c=>{if(!a.has(c)){const f=e.querySelector(`[data-index='${c}']`);f&&e.removeChild(f),I.delete(c)}})}function H(){const e=L();if(!e)return;const{columns:o,rowHeight:r,itemWidth:s}=W();I.forEach(n=>{const t=e.querySelector(`[data-index='${n}']`);if(t){const l=Math.floor(n/o),a=n%o;t.style.top=`${l*r}px`,t.style.left=`${a*s}px`,t.style.width=`${s}px`,t.style.height=`${r}px`}})}function fe(){const e=L();e&&(e.innerHTML="",I.clear())}const O=1e3,U=-85,V=new Set;function me(){const e=L();if(!e)return;const o=F(),r=o.length;e.style.height="auto",e.style.overflowX="auto",e.style.overflowY="visible",e.style.whiteSpace="nowrap",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="flex-start",e.style.scrollSnapType="x mandatory",e.classList.add("py-40"),e.classList.add("coverflow-mode");let s=e.parentElement?.querySelector(".scroll-indicator");if(!s){s=document.createElement("div"),s.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),s.style.height="30px";for(let n=0;n<80;n++){const t=document.createElement("div");t.classList.add("indicator-line","bg-white","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),t.dataset.index=n.toString(),s.appendChild(t)}e.parentElement&&e.parentElement.insertBefore(s,e)}for(let n=0;n<r;n++)if(!V.has(n)){const t=o[n],l=ee({img:t?.img,album:t?.album,artist:t?.artist,link:t?.link});l.classList.add("coverflow-item"),l.classList.add("w-sm"),l.style.position="relative",l.style.display="inline-block",l.style.scrollSnapAlign="center",l.style.flexShrink="0",l.dataset.index=n.toString(),e.appendChild(l),V.add(n)}if(r>0){const n=Math.floor(r/2),t=e.querySelector(`[data-index="${n}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}}function he(e){if(!L())return;F().length}function ge(){const e=L();if(!e)return;e.innerHTML="",V.clear(),e.classList.remove("coverflow-mode");const o=e.parentElement?.querySelector(".scroll-indicator");o&&o.remove(),e.style.overflowX="",e.style.overflowY="",e.style.whiteSpace="",e.style.display="",e.style.alignItems="",e.style.justifyContent="",e.style.scrollSnapType=""}function te(){const e=L();if(!e)return;const o=window.innerWidth,r=e.scrollLeft,s=o/2+r,n=e.querySelectorAll(".coverflow-item"),t=8;let l=-1,a=1/0,c=null;n.forEach(g=>{const i=g,E=g.getBoundingClientRect(),p=E.left+E.width/2+r,y=Math.abs(s-p);y<a&&(a=y,l=parseInt(i.dataset.index||"0",10),c=i);const d=i.querySelector(".text-container");if(d){const j=o/8,w=Math.max(0,1-y/j);w>0?(d.classList.remove("opacity-0"),d.style.opacity=w.toString()):(d.classList.add("opacity-0"),d.style.opacity="0")}});const f=e.parentElement?.querySelector(".scroll-indicator");if(f){n.length;const g=r/(e.scrollWidth-o),i=Math.floor(g*99);f.querySelectorAll(".indicator-line").forEach((p,y)=>{const d=p;y===i?(d.style.transform="scale(2.5, 2.5)",d.style.transformOrigin="center",d.style.opacity="1"):(d.style.transform="scale(1, 1)",d.style.transformOrigin="center",d.style.opacity="0.3")})}n.forEach(g=>{const i=g;i===c?i.classList.add("center-album"):i.classList.remove("center-album")}),he();const h=Math.max(0,l-t),M=l+t;n.forEach(g=>{const i=g,E=parseInt(i.dataset.index||"0",10),p=g.getBoundingClientRect(),y=p.left+p.width/2+r,d=Math.abs(s-y);if(i.style.transform="none",i.style.opacity="0.5",i.style.marginLeft=`${U}px`,i.style.marginRight=`${U}px`,E>=h&&E<=M){const j=o/2,w=Math.min(d/j,1),N=30+w*30,D=1-w*.4,P=1-w*.7,ne=Math.floor(100-w*50);i.style.zIndex=ne.toString();let R=N;if(d<p.width/2){const oe=d/(p.width/2);R=N*oe}d<p.width/2&&d<20?(i.style.transform=`perspective(${O}px) scale(1)`,i.style.opacity="1"):y<s?(i.style.transform=`perspective(${O}px) rotateY(${R}deg) scale(${P})`,i.style.opacity=D.toString()):(i.style.transform=`perspective(${O}px) rotateY(-${R}deg) scale(${P})`,i.style.opacity=D.toString())}})}function pe(){const e=document.getElementById("controlsContainer");if(!e)return;[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{Z(),B(),z()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{m()==="grid"&&ce()&&(q(),b(x()),H(),$())}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{m()==="grid"&&ae()&&(q(),b(x()),H(),$())}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const l=m()==="grid"?"coverflow":"grid";de(l);const a=document.querySelector("#viewToggleBtn .material-symbols-rounded");a&&(a.textContent=l==="grid"?"view_carousel":"grid_view"),B(),l==="grid"&&b(x()),z(),l==="coverflow"&&te()}},{id:"themeBtn",icon:"light_mode",handler:()=>{const t=document.documentElement,l=document.querySelector("#themeBtn .material-symbols-rounded");t.classList.contains("dark")?(t.classList.remove("dark"),l&&(l.textContent="dark_mode"),localStorage.setItem("theme","light")):(t.classList.add("dark"),l&&(l.textContent="light_mode"),localStorage.setItem("theme","dark"))}}].forEach(t=>{const l=document.createElement("button");l.id=t.id,l.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-150 ease-out"+(t.className?` ${t.className}`:"");const a=document.createElement("span");a.className="material-symbols-rounded",a.textContent=t.icon,l.appendChild(a),t.handler&&l.addEventListener("click",t.handler),e.appendChild(l)});const r=localStorage.getItem("theme"),s=document.documentElement,n=document.querySelector("#themeBtn .material-symbols-rounded");r==="light"?(s.classList.remove("dark"),n&&(n.textContent="dark_mode")):(s.classList.add("dark"),n&&(n.textContent="light_mode"))}function K(e,o){let r=null;return function(...s){r!==null&&clearTimeout(r),r=setTimeout(()=>e.apply(this,s),o)}}function z(){const e=m();e==="grid"?$():e==="coverflow"&&me()}function B(){const e=m();e==="grid"?fe():e==="coverflow"&&ge()}function ye(){const e=document.getElementById("grid"),o=document.querySelector(".scrim");e&&o&&(e.addEventListener("mouseover",n=>{const t=n.target;if(m()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){o.classList.remove("opacity-0"),o.classList.add("opacity-70");const l=t.classList.contains("album-card")?t:t.closest(".album-card");l&&l.classList.add("z-50")}}),e.addEventListener("mouseout",n=>{const t=n.target;if(m()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){o.classList.remove("opacity-70"),o.classList.add("opacity-0");const l=t.classList.contains("album-card")?t:t.closest(".album-card");l&&l.classList.remove("z-50")}})),window.addEventListener("resize",K(()=>{m()==="grid"&&(q(),b(x()),H(),$())},200));let r=!1;window.addEventListener("scroll",()=>{m()==="grid"&&!r&&(requestAnimationFrame(()=>{$(),r=!1}),r=!0)});let s=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{m()==="coverflow"&&!s&&(requestAnimationFrame(()=>{te(),s=!1}),s=!0)}),document.getElementById("searchInput")?.addEventListener("input",K(n=>{const t=n.target;X(t.value),B(),m()==="grid"&&b(x()),z();const l=document.querySelector(".arrow-back"),a=t;t.value.length>0?(l?.classList.remove("invisible","-translate-x-2"),l?.classList.add("visible","translate-x-0"),a.classList.remove("-translate-x-9")):(l?.classList.remove("visible","translate-x-0"),l?.classList.add("invisible","-translate-x-2"),a.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const n=document.getElementById("searchInput");if(n){n.value="",X(""),B(),m()==="grid"&&b(x()),z();const t=document.querySelector(".arrow-back");t?.classList.remove("visible","translate-x-0"),t?.classList.add("invisible","-translate-x-2"),n.classList.add("-translate-x-9")}})}function be(){document.addEventListener("DOMContentLoaded",async()=>{ie(),await le(),Z(),b(x()),z(),pe(),ye()})}be();
