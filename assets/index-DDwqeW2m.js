(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();let i=[],m=[];async function R(){try{const t=await fetch("library_full.json");if(!t.ok)throw new Error("Failed to load album data from library_full.json");return i=await t.json(),console.log("Loaded library:",i.length,"albums"),m=i,i}catch(t){return console.error("Error loading album data:",t),i=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",i.length,"albums"),m=i,i}}function z(t){if(!t){m=i;return}const e=t.toLowerCase();m=i.filter(o=>{const r=o.album.toLowerCase(),n=o.artist.toLowerCase();return r.includes(e)||n.includes(e)||r.includes(e.slice(0,-1))||n.includes(e.slice(0,-1))||e.length>1&&(r.includes(e.slice(1))||n.includes(e.slice(1)))})}function H(){return m}function g(){return m.length}function q(){for(let t=i.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[i[t],i[e]]=[i[e],i[t]]}m===i&&(m=i)}let p=null,y=null,v=3;const N=1,W=5;let k=0,$=0,j=176,w=176,B=0,M=0;function T(){if(p=document.querySelector("main"),y=document.querySelector("#grid"),!p||!y){console.error("Grid container or grid element not found");return}L(),f(0)}function L(){if(!p)return;const e={1:8,2:7,3:5,4:4,5:2}[v],o=p.offsetWidth;w=Math.floor((o-(e-1)*16)/e),j=w}function f(t){!p||!y||(M=t,k=Math.floor(p.offsetWidth/w),$=Math.ceil(M/k),B=$*w,y.style.height=`${B}px`)}function _(){return v<W?(v++,!0):!1}function P(){return v>N?(v--,!0):!1}function S(){return{columns:k,rowHeight:j,itemWidth:w,totalAlbums:M}}function A(){return y}function D({img:t,album:e,artist:o,link:r}){const n=document.createElement("a");return n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("href",r||"#"),n.className="album-card relative overflow-hidden flex flex-col p-2 transition-all duration-500 ease-out group hover:z-1",n.innerHTML=`
    <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
      <div class="album-image w-full h-full object-cover flex-shrink-0">
        <img class="w-full object-cover" loading="lazy" src="${t||""}" alt="${e||"Album"}">
        <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
      </div>
      <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
      <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
        <h3 class="font-bold text-zinc-100 mb-1 truncate">${e||"Unknown Album"}</h3>
        <p class="text-xs text-zinc-300 truncate mb-1">${o||"Unknown Artist"}</p>
      </div>
    </div>
  `,n}const b=new Set;function F(){const{rowHeight:t,columns:e,totalAlbums:o}=S(),r=3,n=window.scrollY,l=window.innerHeight,a=Math.floor(n/t)-r,h=Math.ceil((n+l)/t)+r,s=Math.max(0,a),c=Math.min(Math.ceil(o/e),h),d=s*e,x=Math.min(o,c*e);return{startIndex:d,endIndex:x}}function u(){const t=A();if(!t)return;const{startIndex:e,endIndex:o}=F(),{columns:r,rowHeight:n,itemWidth:l}=S(),a=H(),h=new Set;for(let s=e;s<o;s++)if(h.add(s),!b.has(s)){const c=a[s],d=D({img:c?.img,album:c?.album,artist:c?.artist,link:c?.link}),x=Math.floor(s/r),O=s%r;d.style.position="absolute",d.style.top=`${x*n}px`,d.style.left=`${O*l}px`,d.style.width=`${l}px`,d.style.height=`${n}px`,d.dataset.index=s.toString(),t.appendChild(d),b.add(s)}b.forEach(s=>{if(!h.has(s)){const c=t.querySelector(`[data-index='${s}']`);c&&t.removeChild(c),b.delete(s)}})}function E(){const t=A();if(!t)return;const{columns:e,rowHeight:o,itemWidth:r}=S();b.forEach(n=>{const l=t.querySelector(`[data-index='${n}']`);if(l){const a=Math.floor(n/e),h=n%e;l.style.top=`${a*o}px`,l.style.left=`${h*r}px`,l.style.width=`${r}px`,l.style.height=`${o}px`}})}function I(){const t=A();t&&(t.innerHTML="",b.clear())}function C(t,e){let o=null;return function(...r){o!==null&&clearTimeout(o),o=setTimeout(()=>t.apply(this,r),e)}}function G(){document.getElementById("zoomInBtn")?.addEventListener("click",()=>{_()&&(L(),f(g()),E(),u())}),document.getElementById("zoomOutBtn")?.addEventListener("click",()=>{P()&&(L(),f(g()),E(),u())}),document.getElementById("shuffleBtn")?.addEventListener("click",()=>{q(),I(),u()}),window.addEventListener("resize",C(()=>{L(),f(g()),E(),u()},200));let t=!1;window.addEventListener("scroll",()=>{t||(requestAnimationFrame(()=>{u(),t=!1}),t=!0)}),document.getElementById("searchInput")?.addEventListener("input",C(e=>{const o=e.target;z(o.value),I(),f(g()),u();const r=document.querySelector(".arrow-back"),n=o;o.value.length>0?(r?.classList.remove("invisible","-translate-x-2"),r?.classList.add("visible","translate-x-0"),n.classList.remove("-translate-x-9")):(r?.classList.remove("visible","translate-x-0"),r?.classList.add("invisible","-translate-x-2"),n.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const e=document.getElementById("searchInput");if(e){e.value="",z(""),I(),f(g()),u();const o=document.querySelector(".arrow-back");o?.classList.remove("visible","translate-x-0"),o?.classList.add("invisible","-translate-x-2"),e.classList.add("-translate-x-9")}}),document.getElementById("themeBtn")?.addEventListener("click",()=>{const e=document.documentElement,o=document.querySelector("#themeBtn .material-symbols-rounded");e.classList.contains("dark")?(e.classList.remove("dark"),o&&(o.textContent="dark_mode"),localStorage.setItem("theme","light")):(e.classList.add("dark"),o&&(o.textContent="light_mode"),localStorage.setItem("theme","dark"))}),document.addEventListener("DOMContentLoaded",()=>{const e=localStorage.getItem("theme"),o=document.documentElement,r=document.querySelector("#themeBtn .material-symbols-rounded");e==="light"?(o.classList.add("light"),r&&(r.textContent="light_mode")):(o.classList.remove("light"),r&&(r.textContent="dark_mode"))})}function U(){document.addEventListener("DOMContentLoaded",async()=>{T(),await R(),q(),f(g()),u(),G()})}U();
