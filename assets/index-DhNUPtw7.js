(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const t of s.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&i(t)}).observe(document,{childList:!0,subtree:!0});function r(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=r(e);fetch(e.href,s)}})();let u=[],y=[];async function le(){try{const n=await fetch("library_full.json");if(!n.ok)throw new Error("Failed to load album data from library_full.json");return u=await n.json(),console.log("Loaded library:",u.length,"albums"),y=u,u}catch(n){return console.error("Error loading album data:",n),u=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",u.length,"albums"),y=u,u}}function G(n){if(!n){y=u;return}const o=n.toLowerCase();y=u.filter(r=>{const i=r.album.toLowerCase(),e=r.artist.toLowerCase();return i.includes(o)||e.includes(o)||i.includes(o.slice(0,-1))||e.includes(o.slice(0,-1))||o.length>1&&(i.includes(o.slice(1))||e.includes(o.slice(1)))})}function J(){return y}function x(){return y.length}function Q(){for(let n=u.length-1;n>0;n--){const o=Math.floor(Math.random()*(n+1));[u[n],u[o]]=[u[o],u[n]]}y===u&&(y=u)}function ee({img:n,album:o,artist:r,link:i}){const e=document.createElement("a");return e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("href",i||"#"),e.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20",m()=="coverflow"?e.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${n||""}" alt="${o||"Album"}">
          <img class="album-image--shadow group-hover:opacity-12 group-hover:blur-[64px] w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${n||""}" alt="${o||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${o||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `:e.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0 flex justify-center items-center">
          <img class="w-full object-cover text-xs text-zinc-300 text-center" loading="lazy" src="${n||""}" alt="${o||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1 animate-pulse"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1">${o||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 mb-1">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `,e}const O=1e3,U=-100,_=new Set,re=new Map,ae=16;let F=0;function ce(){const n=M();if(!n)return;const o=J(),r=o.length;let i=n.parentElement?.querySelector(".scroll-indicator");if(!i){i=document.createElement("div"),i.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),i.style.height="30px";for(let e=0;e<80;e++){const s=document.createElement("div");s.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),s.dataset.index=e.toString(),i.appendChild(s)}n.parentElement&&(n.parentElement.insertBefore(i,n),i.addEventListener("click",e=>{const s=e.target,t=parseInt(s.dataset.index||"0"),l=parseInt(getComputedStyle(n).getPropertyValue("--row-height"));n.scrollTo({top:t*l,behavior:"smooth"})}))}i.addEventListener("click",e=>{e.target;const s=e.clientX-i.getBoundingClientRect().left,t=s/i.getBoundingClientRect().width,l=o[Math.floor((r-1)*t)],a=n.querySelector(`[data-index="${o.indexOf(l)}"]`);a&&a.scrollIntoView({behavior:"smooth"}),console.log(s,t)});for(let e=0;e<r;e++)if(!_.has(e)){const s=o[e],t=ee({img:s?.img,album:s?.album,artist:s?.artist,link:s?.link});t.classList.add("coverflow-item"),t.classList.add("w-sm"),t.style.position="relative",t.style.display="inline-block",t.style.scrollSnapAlign="center",t.style.flexShrink="0",t.dataset.index=e.toString(),n.appendChild(t),_.add(e)}if(r>5){const e=n.querySelector('[data-index="4"]');e&&e.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}}function de(){oe(_)}function W(){const n=performance.now();if(n-F<ae)return;F=n;const o=M();if(!o)return;const r=window.innerWidth,i=o.scrollLeft,e=r/2+i,s=o.querySelectorAll(".coverflow-item"),t=5;let l=-1,a=1/0;const c=[];s.forEach(f=>{const g=f,L=parseInt(g.dataset.index||"0",10),d=f.getBoundingClientRect(),h=d.left+d.width/2+i,w=Math.abs(e-h);re.set(L,{rect:d,centerX:h,distance:w}),c.push({element:g,rect:d,centerX:h,distance:w,index:L}),w<a&&(a=w,l=parseInt(g.dataset.index||"0",10))}),requestAnimationFrame(()=>{const f=o.parentElement?.querySelector(".scroll-indicator");if(f){s.length;const d=i/(o.scrollWidth-r),h=Math.floor(d*99);f.querySelectorAll(".indicator-line").forEach((v,B)=>{const p=v;B===h?(p.style.transform="scale(2.5, 2.5)",p.style.opacity="1"):(p.style.transform="scale(1, 1)",p.style.opacity="0.3")})}const g=Math.max(0,l-t),L=l+t;c.forEach(({element:d,rect:h,centerX:w,distance:v})=>{const B=parseInt(d.dataset.index||"0",10);if(d.style.transform="none",d.style.opacity="1",d.style.marginLeft=`${U}px`,d.style.marginRight=`${U}px`,B>=g&&B<=L){const j=r/2,E=Math.min(v/j,1),P=30+E*30,X=1-E*.7,se=Math.floor(100-E*50);d.style.zIndex=se.toString();let R=P;if(v<h.width/2){const ie=v/(h.width/2);R=P*ie}v<h.width/2&&v<20?d.style.transform=`perspective(${O}px) scale(1)`:w<e?d.style.transform=`perspective(${O}px) rotateY(${R}deg) scale(${X})`:d.style.transform=`perspective(${O}px) rotateY(-${R}deg) scale(${X})`}const p=d.querySelector(".text-container");if(p){const j=r/8,E=Math.max(0,1-v/j);E>0?(p.classList.remove("opacity-0"),p.style.opacity=E.toString()):(p.classList.add("opacity-0"),p.style.opacity="0")}})})}let k=null,S=null,z=3;const ue=1,fe=5;let H=0,K=0,te=176,A=176,Y=0,N=0,ne="grid";function me(){if(k=document.querySelector("main"),S=document.querySelector("#grid"),!k||!S){console.error("Grid container or grid element not found");return}q(),b(0)}function q(){if(!k)return;const o={1:8,2:7,3:5,4:4,5:2}[z],r=k.offsetWidth;A=Math.floor((r-(o-1)*16)/o),te=A}function b(n){!k||!S||(N=n,H=Math.floor(k.offsetWidth/A),K=Math.ceil(N/H),Y=K*A,S.style.height=`${Y}px`)}function pe(){return z<fe?(z++,!0):!1}function ge(){return z>ue?(z--,!0):!1}function D(){return{columns:H,rowHeight:te,itemWidth:A,totalAlbums:N}}function M(){return S}function he(n){let o=["coverflow-mode","py-40","h-auto","overflow-x-auto","overflow-y-visible","whitespace-nowrap","flex","items-center","justify-start","snap-x","snap-mandatory"],r=["grid-mode","mt-30"];const i=M();if(i)if(ne=n,n==="grid"){const e=i.parentElement?.querySelector(".scroll-indicator");e&&e.remove(),i.classList.remove(...o),i.classList.add(...r)}else i.classList.remove(...r),i.classList.add(...o),W(),i.style.height="auto"}function m(){return ne}const I=new Set;function ve(){const{rowHeight:n,columns:o,totalAlbums:r}=D(),i=3,e=window.scrollY,s=window.innerHeight,t=Math.floor(e/n)-i,l=Math.ceil((e+s)/n)+i,a=Math.max(0,t),c=Math.min(Math.ceil(r/o),l),f=a*o,g=Math.min(r,c*o);return{startIndex:f,endIndex:g}}function C(){const n=M();if(!n)return;const{startIndex:o,endIndex:r}=ve(),{columns:i,rowHeight:e,itemWidth:s}=D(),t=J(),l=new Set;for(let a=o;a<r;a++)if(l.add(a),!I.has(a)){const c=t[a],f=ee({img:c?.img,album:c?.album,artist:c?.artist,link:c?.link}),g=Math.floor(a/i),L=a%i;f.style.position="absolute",f.style.top=`${g*e}px`,f.style.left=`${L*s}px`,f.style.width=`${s}px`,f.style.height=`${e}px`,f.dataset.index=a.toString(),n.appendChild(f),I.add(a)}I.forEach(a=>{if(!l.has(a)){const c=n.querySelector(`[data-index='${a}']`);c&&n.removeChild(c),I.delete(a)}})}function V(){const n=M();if(!n)return;const{columns:o,rowHeight:r,itemWidth:i}=D();I.forEach(e=>{const s=n.querySelector(`[data-index='${e}']`);if(s){const t=Math.floor(e/o),l=e%o;s.style.top=`${t*r}px`,s.style.left=`${l*i}px`,s.style.width=`${i}px`,s.style.height=`${r}px`}})}function be(){oe(I)}function ye(){const n=document.getElementById("controlsContainer");if(!n)return;[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{Q(),T(),$()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{m()==="grid"&&ge()&&(q(),b(x()),V(),C())}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{m()==="grid"&&pe()&&(q(),b(x()),V(),C())}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const t=m()==="grid"?"coverflow":"grid";he(t);const l=document.querySelector("#viewToggleBtn .material-symbols-rounded");l&&(l.textContent=t==="grid"?"view_carousel":"grid_view");const a=document.getElementById("zoomInBtn"),c=document.getElementById("zoomOutBtn");a&&c&&(t==="coverflow"?(a.classList.add("w-0","opacity-0","-translate-x-full","collapse"),c.classList.add("w-0","opacity-0","translate-x-full","collapse"),a.classList.remove("px-2"),c.classList.remove("px-2")):(a.classList.remove("w-0","opacity-0","-translate-x-full","collapse"),c.classList.remove("w-0","opacity-0","translate-x-full","collapse"),a.classList.add("px-2"),c.classList.add("px-2"))),T(),t==="grid"&&b(x()),$(),t==="coverflow"&&W()}},{id:"themeBtn",icon:"light_mode",handler:()=>{const s=document.documentElement,t=document.querySelector("#themeBtn .material-symbols-rounded");s.classList.contains("dark")?(s.classList.remove("dark"),t&&(t.textContent="dark_mode"),localStorage.setItem("theme","light")):(s.classList.add("dark"),t&&(t.textContent="light_mode"),localStorage.setItem("theme","dark"))}}].forEach(s=>{const t=document.createElement("button");t.id=s.id,t.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-150 ease-out"+(s.className?` ${s.className}`:"");const l=document.createElement("span");l.className="material-symbols-rounded",l.textContent=s.icon,t.appendChild(l),s.handler&&t.addEventListener("click",s.handler),n.appendChild(t)});const r=localStorage.getItem("theme"),i=document.documentElement,e=document.querySelector("#themeBtn .material-symbols-rounded");r==="light"?(i.classList.remove("dark"),e&&(e.textContent="dark_mode")):(i.classList.add("dark"),e&&(e.textContent="light_mode"))}function Z(n,o){let r=null;return function(...i){r!==null&&clearTimeout(r),r=setTimeout(()=>n.apply(this,i),o)}}function $(){const n=m();n==="grid"?C():n==="coverflow"&&ce()}function T(){const n=m();n==="grid"?be():n==="coverflow"&&de()}function we(){const n=document.getElementById("grid"),o=document.querySelector(".scrim");n&&o&&(n.addEventListener("mouseover",t=>{const l=t.target;if(m()==="grid"&&(l.classList.contains("album-card")||l.closest(".album-card"))){o.classList.remove("opacity-0"),o.classList.add("opacity-70");const a=l.classList.contains("album-card")?l:l.closest(".album-card");a&&a.classList.add("z-50")}}),n.addEventListener("mouseout",t=>{const l=t.target;if(m()==="grid"&&(l.classList.contains("album-card")||l.closest(".album-card"))){o.classList.remove("opacity-70"),o.classList.add("opacity-0");const a=l.classList.contains("album-card")?l:l.closest(".album-card");a&&a.classList.remove("z-50")}})),window.addEventListener("resize",Z(()=>{m()==="grid"&&(q(),b(x()),V(),C())},200));let r=!1;window.addEventListener("scroll",()=>{m()==="grid"&&!r&&(requestAnimationFrame(()=>{C(),r=!1}),r=!0)});let i=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{m()==="coverflow"&&!i&&(requestAnimationFrame(()=>{W(),i=!1}),i=!0)});const e=document.getElementById("searchInput"),s=Z(t=>{G(t),T(),m()==="grid"&&b(x()),$();const l=document.querySelector(".arrow-back");e&&(t.length>0?(l?.classList.remove("invisible","-translate-x-2"),l?.classList.add("visible","translate-x-0"),e.classList.remove("-translate-x-9")):(l?.classList.remove("visible","translate-x-0"),l?.classList.add("invisible","-translate-x-2"),e.classList.add("-translate-x-9")))},200);e?.addEventListener("input",t=>{const l=t.target;s(l.value)}),window.addEventListener("keydown",t=>{e&&(t.ctrlKey||t.altKey||t.metaKey||t.key.length>1&&t.key!=="Backspace"||document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"||document.activeElement.tagName==="SELECT")||(t.key==="Backspace"?e.value.length>0&&(e.value=e.value.slice(0,-1),s(e.value),t.preventDefault()):t.key.length===1&&(document.activeElement!==e&&(e.focus(),e.value=t.key),t.preventDefault())))}),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const t=document.getElementById("searchInput");if(t){t.value="",G(""),T(),m()==="grid"&&b(x()),$();const l=document.querySelector(".arrow-back");l?.classList.remove("visible","translate-x-0"),l?.classList.add("invisible","-translate-x-2"),t.classList.add("-translate-x-9")}})}function oe(n){const o=M();o&&(o.innerHTML="",n.clear())}function xe(){document.addEventListener("DOMContentLoaded",async()=>{me(),await le(),Q(),b(x()),$(),ye(),we()})}xe();
