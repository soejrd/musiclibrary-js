(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(o){if(o.ep)return;o.ep=!0;const t=r(o);fetch(o.href,t)}})();let m=[],v=[];async function se(){try{const e=await fetch("library_full.json");if(!e.ok)throw new Error("Failed to load album data from library_full.json");return m=await e.json(),console.log("Loaded library:",m.length,"albums"),v=m,m}catch(e){return console.error("Error loading album data:",e),m=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",m.length,"albums"),v=m,m}}function X(e){if(!e){v=m;return}const n=e.toLowerCase();v=m.filter(r=>{const l=r.album.toLowerCase(),o=r.artist.toLowerCase();return l.includes(n)||o.includes(n)||l.includes(n.slice(0,-1))||o.includes(n.slice(0,-1))||n.length>1&&(l.includes(n.slice(1))||o.includes(n.slice(1)))})}function F(){return v}function x(){return v.length}function Z(){for(let e=m.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[m[e],m[n]]=[m[n],m[e]]}v===m&&(v=m)}let S=null,k=null,C=3;const le=1,re=5;let T=0,G=0,J=176,z=176,Y=0,_=0,Q="grid";function ie(){if(S=document.querySelector("main"),k=document.querySelector("#grid"),!S||!k){console.error("Grid container or grid element not found");return}B(),b(0)}function B(){if(!S)return;const n={1:8,2:7,3:5,4:4,5:2}[C],r=S.offsetWidth;z=Math.floor((r-(n-1)*16)/n),J=z}function b(e){!S||!k||(_=e,T=Math.floor(S.offsetWidth/z),G=Math.ceil(_/T),Y=G*z,k.style.height=`${Y}px`)}function ae(){return C<re?(C++,!0):!1}function ce(){return C>le?(C--,!0):!1}function W(){return{columns:T,rowHeight:J,itemWidth:z,totalAlbums:_}}function L(){return k}function de(e){Q=e}function f(){return Q}function ee({img:e,album:n,artist:r,link:l}){const o=document.createElement("a");o.setAttribute("target","_blank"),o.setAttribute("rel","noopener noreferrer"),o.setAttribute("href",l||"#"),o.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20";const t=document.getElementById("grid");return t&&t.style.display==="flex"&&t.style.overflowX==="auto"?o.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${n||"Album"}">
          <img class="album-image--shadow w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${e||""}" alt="${n||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${n||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `:o.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${n||"Album"}">
          <div class="animate-pulse bg-zinc-800 h-full w-full object-cover"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1 truncate">${n||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 truncate mb-1">${r||"Unknown Artist"}</p>
        </div>
      </div>
    `,o}const I=new Set;function ue(){const{rowHeight:e,columns:n,totalAlbums:r}=W(),l=3,o=window.scrollY,t=window.innerHeight,s=Math.floor(o/e)-l,c=Math.ceil((o+t)/e)+l,i=Math.max(0,s),d=Math.min(Math.ceil(r/n),c),p=i*n,M=Math.min(r,d*n);return{startIndex:p,endIndex:M}}function A(){const e=L();if(!e)return;e.classList.add("py-5"),e.classList.remove("coverflow-mode");const{startIndex:n,endIndex:r}=ue(),{columns:l,rowHeight:o,itemWidth:t}=W(),s=F(),c=new Set;for(let i=n;i<r;i++)if(c.add(i),!I.has(i)){const d=s[i],p=ee({img:d?.img,album:d?.album,artist:d?.artist,link:d?.link}),M=Math.floor(i/l),h=i%l;p.style.position="absolute",p.style.top=`${M*o}px`,p.style.left=`${h*t}px`,p.style.width=`${t}px`,p.style.height=`${o}px`,p.dataset.index=i.toString(),e.appendChild(p),I.add(i)}I.forEach(i=>{if(!c.has(i)){const d=e.querySelector(`[data-index='${i}']`);d&&e.removeChild(d),I.delete(i)}})}function H(){const e=L();if(!e)return;const{columns:n,rowHeight:r,itemWidth:l}=W();I.forEach(o=>{const t=e.querySelector(`[data-index='${o}']`);if(t){const s=Math.floor(o/n),c=o%n;t.style.top=`${s*r}px`,t.style.left=`${c*l}px`,t.style.width=`${l}px`,t.style.height=`${r}px`}})}function me(){const e=L();e&&(e.innerHTML="",I.clear())}const R=1e3,U=-85,V=new Set;function fe(){const e=L();if(!e)return;const n=F(),r=n.length;e.style.height="auto",e.style.overflowX="auto",e.style.overflowY="visible",e.style.whiteSpace="nowrap",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="flex-start",e.style.scrollSnapType="x mandatory",e.classList.add("py-40"),e.classList.add("coverflow-mode");let l=e.parentElement?.querySelector(".scroll-indicator");if(!l){l=document.createElement("div"),l.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),l.style.height="30px";for(let o=0;o<80;o++){const t=document.createElement("div");t.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),t.dataset.index=o.toString(),l.appendChild(t)}e.parentElement&&e.parentElement.insertBefore(l,e)}for(let o=0;o<r;o++)if(!V.has(o)){const t=n[o],s=ee({img:t?.img,album:t?.album,artist:t?.artist,link:t?.link});s.classList.add("coverflow-item"),s.classList.add("w-sm"),s.style.position="relative",s.style.display="inline-block",s.style.scrollSnapAlign="center",s.style.flexShrink="0",s.dataset.index=o.toString(),e.appendChild(s),V.add(o)}if(r>0){const o=Math.floor(r/2),t=e.querySelector(`[data-index="${o}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}}function pe(e){if(!L())return;F().length}function he(){const e=L();if(!e)return;e.innerHTML="",V.clear(),e.classList.remove("coverflow-mode");const n=e.parentElement?.querySelector(".scroll-indicator");n&&n.remove(),e.style.overflowX="",e.style.overflowY="",e.style.whiteSpace="",e.style.display="",e.style.alignItems="",e.style.justifyContent="",e.style.scrollSnapType=""}function te(){const e=L();if(!e)return;const n=window.innerWidth,r=e.scrollLeft,l=n/2+r,o=e.querySelectorAll(".coverflow-item"),t=8;let s=-1,c=1/0,i=null;o.forEach(h=>{const a=h,E=h.getBoundingClientRect(),g=E.left+E.width/2+r,y=Math.abs(l-g);y<c&&(c=y,s=parseInt(a.dataset.index||"0",10),i=a);const u=a.querySelector(".text-container");if(u){const j=n/8,w=Math.max(0,1-y/j);w>0?(u.classList.remove("opacity-0"),u.style.opacity=w.toString()):(u.classList.add("opacity-0"),u.style.opacity="0")}});const d=e.parentElement?.querySelector(".scroll-indicator");if(d){o.length;const h=r/(e.scrollWidth-n),a=Math.floor(h*99);d.querySelectorAll(".indicator-line").forEach((g,y)=>{const u=g;y===a?(u.style.transform="scale(2.5, 2.5)",u.style.transformOrigin="center",u.style.opacity="1"):(u.style.transform="scale(1, 1)",u.style.transformOrigin="center",u.style.opacity="0.3")})}o.forEach(h=>{const a=h;a===i?a.classList.add("center-album"):a.classList.remove("center-album")}),pe();const p=Math.max(0,s-t),M=s+t;o.forEach(h=>{const a=h,E=parseInt(a.dataset.index||"0",10),g=h.getBoundingClientRect(),y=g.left+g.width/2+r,u=Math.abs(l-y);if(a.style.transform="none",a.style.opacity="0.5",a.style.marginLeft=`${U}px`,a.style.marginRight=`${U}px`,E>=p&&E<=M){const j=n/2,w=Math.min(u/j,1),N=30+w*30,D=1-w*.4,P=1-w*.7,oe=Math.floor(100-w*50);a.style.zIndex=oe.toString();let O=N;if(u<g.width/2){const ne=u/(g.width/2);O=N*ne}u<g.width/2&&u<20?(a.style.transform=`perspective(${R}px) scale(1)`,a.style.opacity="1"):y<l?(a.style.transform=`perspective(${R}px) rotateY(${O}deg) scale(${P})`,a.style.opacity=D.toString()):(a.style.transform=`perspective(${R}px) rotateY(-${O}deg) scale(${P})`,a.style.opacity=D.toString())}})}function ge(){const e=document.getElementById("controlsContainer");if(!e)return;[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{Z(),q(),$()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{f()==="grid"&&ce()&&(B(),b(x()),H(),A())}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{f()==="grid"&&ae()&&(B(),b(x()),H(),A())}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const s=f()==="grid"?"coverflow":"grid";de(s);const c=document.querySelector("#viewToggleBtn .material-symbols-rounded");c&&(c.textContent=s==="grid"?"view_carousel":"grid_view");const i=document.getElementById("zoomInBtn"),d=document.getElementById("zoomOutBtn");i&&d&&(s==="coverflow"?(i.classList.add("w-0","opacity-0","-translate-x-full","collapse"),d.classList.add("w-0","opacity-0","translate-x-full","collapse"),i.classList.remove("px-2"),d.classList.remove("px-2")):(i.classList.remove("w-0","opacity-0","-translate-x-full","collapse"),d.classList.remove("w-0","opacity-0","translate-x-full","collapse"),i.classList.add("px-2"),d.classList.add("px-2"))),q(),s==="grid"&&b(x()),$(),s==="coverflow"&&te()}},{id:"themeBtn",icon:"light_mode",handler:()=>{const t=document.documentElement,s=document.querySelector("#themeBtn .material-symbols-rounded");t.classList.contains("dark")?(t.classList.remove("dark"),s&&(s.textContent="dark_mode"),localStorage.setItem("theme","light")):(t.classList.add("dark"),s&&(s.textContent="light_mode"),localStorage.setItem("theme","dark"))}}].forEach(t=>{const s=document.createElement("button");s.id=t.id,s.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-150 ease-out"+(t.className?` ${t.className}`:"");const c=document.createElement("span");c.className="material-symbols-rounded",c.textContent=t.icon,s.appendChild(c),t.handler&&s.addEventListener("click",t.handler),e.appendChild(s)});const r=localStorage.getItem("theme"),l=document.documentElement,o=document.querySelector("#themeBtn .material-symbols-rounded");r==="light"?(l.classList.remove("dark"),o&&(o.textContent="dark_mode")):(l.classList.add("dark"),o&&(o.textContent="light_mode"))}function K(e,n){let r=null;return function(...l){r!==null&&clearTimeout(r),r=setTimeout(()=>e.apply(this,l),n)}}function $(){const e=f();e==="grid"?A():e==="coverflow"&&fe()}function q(){const e=f();e==="grid"?me():e==="coverflow"&&he()}function ye(){const e=document.getElementById("grid"),n=document.querySelector(".scrim");e&&n&&(e.addEventListener("mouseover",o=>{const t=o.target;if(f()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){n.classList.remove("opacity-0"),n.classList.add("opacity-70");const s=t.classList.contains("album-card")?t:t.closest(".album-card");s&&s.classList.add("z-50")}}),e.addEventListener("mouseout",o=>{const t=o.target;if(f()==="grid"&&(t.classList.contains("album-card")||t.closest(".album-card"))){n.classList.remove("opacity-70"),n.classList.add("opacity-0");const s=t.classList.contains("album-card")?t:t.closest(".album-card");s&&s.classList.remove("z-50")}})),window.addEventListener("resize",K(()=>{f()==="grid"&&(B(),b(x()),H(),A())},200));let r=!1;window.addEventListener("scroll",()=>{f()==="grid"&&!r&&(requestAnimationFrame(()=>{A(),r=!1}),r=!0)});let l=!1;document.getElementById("grid")?.addEventListener("scroll",()=>{f()==="coverflow"&&!l&&(requestAnimationFrame(()=>{te(),l=!1}),l=!0)}),document.getElementById("searchInput")?.addEventListener("input",K(o=>{const t=o.target;X(t.value),q(),f()==="grid"&&b(x()),$();const s=document.querySelector(".arrow-back"),c=t;t.value.length>0?(s?.classList.remove("invisible","-translate-x-2"),s?.classList.add("visible","translate-x-0"),c.classList.remove("-translate-x-9")):(s?.classList.remove("visible","translate-x-0"),s?.classList.add("invisible","-translate-x-2"),c.classList.add("-translate-x-9"))},200)),document.querySelector(".arrow-back")?.addEventListener("click",()=>{const o=document.getElementById("searchInput");if(o){o.value="",X(""),q(),f()==="grid"&&b(x()),$();const t=document.querySelector(".arrow-back");t?.classList.remove("visible","translate-x-0"),t?.classList.add("invisible","-translate-x-2"),o.classList.add("-translate-x-9")}})}function be(){document.addEventListener("DOMContentLoaded",async()=>{ie(),await se(),Z(),b(x()),$(),ge(),ye()})}be();
