(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();let d=[],w=[];async function ue(){try{const e=await fetch("library_full.json");if(!e.ok)throw new Error("Failed to load album data from library_full.json");return d=await e.json(),console.log("Loaded library:",d.length,"albums"),w=d,d}catch(e){return console.error("Error loading album data:",e),d=[{album:"Section.80",n:16,img:"https://i.scdn.co/image/ab67616d0000b27333d50ba80791b4ed381f5221",artist:"Kendrick Lamar",link:"spotify:album:13WjgUEEAQp0d9JqojlWp1",toDelete:!0},{album:"InnerSpeaker",n:11,img:"https://i.scdn.co/image/ab67616d0000b273cbcddf5b9309f972363ae406",artist:"Tame Impala",link:"spotify:album:79Ij6ZNKHVFVRNvXoNbvZO",toDelete:!1}],console.log("Using fallback data with",d.length,"albums"),w=d,d}}function fe(e){if(!e){w=d;return}const t=e.toLowerCase();w=d.filter(n=>{const s=n.album.toLowerCase(),o=n.artist.toLowerCase();return s.includes(t)||o.includes(t)||s.includes(t.slice(0,-1))||o.includes(t.slice(0,-1))||t.length>1&&(s.includes(t.slice(1))||o.includes(t.slice(1)))})}function N(){return w}function K(){return w.length}function te(){for(let e=d.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[d[e],d[t]]=[d[t],d[e]]}w===d&&(w=d)}function ne({img:e,album:t,artist:n,link:s}){const o=document.createElement("a");return o.setAttribute("target","_blank"),o.setAttribute("rel","noopener noreferrer"),o.setAttribute("href",s||"#"),o.className="album-card relative flex flex-col p-2 transition-all duration-500 ease-out group hover:z-20",p()=="coverflow"?o.innerHTML=`
      <div class="wrapper w-full flex flex-col relative rounded-sm group-hover:scale-105 transition-all duration-200 ease-out overflow-visible">
        <div class="album-image w-full h-auto object-cover flex-shrink-0 relative overflow-visible">
          <img class="w-full object-cover" loading="lazy" src="${e||""}" alt="${t||"Album"}">
          <img class="album-image--shadow group-hover:opacity-12 group-hover:blur-[64px] w-full object-cover pointer-events-none absolute top-0 left-0 transform -scale-200 transform-origin-center -z-1 opacity-0 transition-all duration-[1s] ease-out" loading="lazy" src="${e||""}" alt="${t||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1"></div>
        </div>
        <div class="text-container mt-6 flex flex-col opacity-0 transition-opacity duration-100 ease-out">
          <h3 class="text-4xl font-bold dark:text-zinc-100 text-zinc-950 mb-2 truncate">${t||"Unknown Album"}</h3>
          <p class="text-lg dark:text-zinc-300 text-zinc-600 truncate">${n||"Unknown Artist"}</p>
        </div>
      </div>
    `:o.innerHTML=`
      <div class="wrapper w-full h-full flex flex-col relative rounded-sm overflow-hidden group-hover:shadow-md transition-all duration-200 ease-out">
        <div class="album-image w-full h-full object-cover flex-shrink-0 flex justify-center items-center">
          <img class="w-full object-cover text-xs text-zinc-300 text-center" loading="lazy" src="${e||""}" alt="${t||"Album"}">
          <div class="bg-zinc-800 h-full w-full object-cover absolute inset-0 -z-1 animate-pulse"></div>
        </div>
        <div class="scrim absolute top-0 left-0 w-full h-full bg-linear-to-t from-black to-transparent opacity-0 group-hover:opacity-70 transition-all duration-100 ease-out"></div>
        <div class="p-2 flex flex-col justify-between flex-grow absolute bottom-0 group-hover:opacity-100 opacity-0 translate-y-1 group-hover:translate-y-0 transition-all duration-100 ease-out">
          <h3 class="font-bold text-zinc-100 mb-1">${t||"Unknown Album"}</h3>
          <p class="text-xs text-zinc-300 mb-1">${n||"Unknown Artist"}</p>
        </div>
      </div>
    `,o}const F=1e3,T=-100,oe=80,I=new Set,me=16;let J=0;function he(){const e=x();if(!e)return;const t=N(),n=t.length,s=Math.min(n,20),o=document.createElement("div");o.style.width=`${n*150}px`,o.style.height="1px",e.appendChild(o);let l=e.parentElement?.querySelector(".scroll-indicator");if(!l){l=document.createElement("div"),l.classList.add("scroll-indicator","max-w-2xl","mx-auto","flex","justify-between","bottom-20","absolute","left-0","right-0","px-4","z-105"),l.style.height="30px";for(let r=0;r<oe;r++){const a=document.createElement("div");a.classList.add("indicator-line","bg-zinc-950","dark:bg-gray-200","opacity-30","transition-all","duration-300","ease-out","w-[1px]","h-3"),a.dataset.index=r.toString(),l.appendChild(a)}e.parentElement&&e.parentElement.insertBefore(l,e),l.addEventListener("click",r=>ge(r,e,n))}for(let r=0;r<s;r++){const a=t[r],i=se(a,r);e.appendChild(i),I.add(r)}if(n>5){const r=e.querySelector('[data-index="4"]');r&&r.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}$()}function pe(){const e=x();if(e){for(;e.firstChild;)e.removeChild(e.firstChild);I.clear()}}function se(e,t){const n=ne({img:e?.img,album:e?.album,artist:e?.artist,link:e?.link});n.classList.add("coverflow-item","w-sm"),n.style.position="absolute",n.style.display="inline-block",n.style.scrollSnapAlign="center",n.style.flexShrink="0",n.dataset.index=t.toString();const s=150;return n.style.left=`${t*s}px`,n}function $(){const e=performance.now();if(e-J<me)return;J=e;const t=x();if(!t)return;const n=N(),s=n.length,o=window.innerWidth,l=t.scrollLeft,r=o/2+l,a=10,i=150,f=Math.floor(l/i),h=Math.max(0,f-a),g=Math.min(s-1,f+a),L=new Set;for(let c=h;c<=g;c++)L.add(c);I.forEach(c=>{if(!L.has(c)){const b=t.querySelector(`[data-index="${c}"]`);b&&t.removeChild(b),I.delete(c)}}),L.forEach(c=>{if(!I.has(c)){const b=n[c],m=se(b,c);t.appendChild(m),I.add(c)}});const D=t.querySelectorAll(".coverflow-item");requestAnimationFrame(()=>{const c=t.parentElement?.querySelector(".scroll-indicator");if(c){const b=s*i,m=l/(b-o),E=Math.floor(m*(oe-1));c.querySelectorAll(".indicator-line").forEach((v,W)=>{const y=v;W===E?(y.style.transform="scale(2.5, 2.5)",y.style.opacity="1"):(y.style.transform="scale(1, 1)",y.style.opacity="0.3")})}D.forEach(b=>{const m=b;parseInt(m.dataset.index||"0",10);const E=m.getBoundingClientRect(),B=E.left+E.width/2+l,v=Math.abs(r-B);m.style.transform="none",m.style.opacity="1",m.style.marginLeft=`${T}px`,m.style.marginRight=`${T}px`;const W=o/2,y=Math.min(v/W,1),X=30+y*30,Y=1-y*.7,de=Math.floor(100-y*50);m.style.zIndex=de.toString();let q=X;if(v<E.width/2){const G=v/(E.width/2);q=X*G}v<E.width/2&&v<20?m.style.transform=`perspective(${F}px) scale(1)`:B<r?m.style.transform=`perspective(${F}px) rotateY(${q}deg) scale(${Y})`:m.style.transform=`perspective(${F}px) rotateY(-${q}deg) scale(${Y})`;const M=m.querySelector(".text-container");if(M){const G=o/16,Z=Math.max(0,1-v/G);Z>0?(M.classList.remove("opacity-0"),M.style.opacity=Z.toString()):(M.classList.add("opacity-0"),M.style.opacity="0")}})})}function ge(e,t,n){const o=window.innerWidth,l=e.currentTarget.getBoundingClientRect(),a=(e.clientX-l.left)/l.width,i=n*(150+Math.abs(T)),f=a*(i-o),h=Math.floor((f+o/2)/(150+Math.abs(T))),g=t.querySelector(`[data-index="${h}"]`);if(g){const L=g.offsetLeft,D=g.offsetWidth,c=L-o/2+D/2;t.scrollTo({left:c,behavior:"smooth"})}else t.scrollTo({left:f,behavior:"smooth"})}let S=null,R=null,k=3;const be=1,ve=5;let V=0,Q=0,le=176,z=176,ee=0,j=0,re="grid";function ye(){if(S=document.querySelector("main"),R=document.querySelector("#grid"),!S||!R){console.error("Grid container or grid element not found");return}ie(),O(0)}function ie(){if(!S)return;const t={1:8,2:7,3:5,4:4,5:2}[k],n=S.offsetWidth;z=Math.floor((n-(t-1)*16)/t),le=z}function O(e){!S||!R||(j=e,V=Math.floor(S.offsetWidth/z),Q=Math.ceil(j/V),ee=Q*z,R.style.height=`${ee}px`)}function we(){return k<ve?(k++,!0):!1}function xe(){return k>be?(k--,!0):!1}function P(){return{columns:V,rowHeight:le,itemWidth:z,totalAlbums:j}}function x(){return R}function Le(e){const t=["coverflow-mode","py-40","overflow-x-auto","scroll-smooth","overflow-y-visible","whitespace-nowrap","flex","items-center","justify-start","snap-x","snap-mandatory"],n=["grid-mode","mt-30"],s=x();if(s)if(re=e,e==="grid"){const o=s.parentElement?.querySelector(".scroll-indicator");o&&o.remove(),s.classList.remove(...t),s.classList.add(...n)}else s.classList.remove(...n),s.classList.add(...t),$(),s.style.height="100vh"}function p(){return re}const C=new Set;function Ee(){const{rowHeight:e,columns:t,totalAlbums:n}=P(),s=3,o=window.scrollY,l=window.innerHeight,r=Math.floor(o/e)-s,a=Math.ceil((o+l)/e)+s,i=Math.max(0,r),f=Math.min(Math.ceil(n/t),a),h=i*t,g=Math.min(n,f*t);return{startIndex:h,endIndex:g}}function U(){const e=x();if(!e)return;const{startIndex:t,endIndex:n}=Ee(),{columns:s,rowHeight:o,itemWidth:l}=P(),r=N(),a=new Set;for(let i=t;i<n;i++)if(a.add(i),!C.has(i)){const f=r[i],h=ne({img:f?.img,album:f?.album,artist:f?.artist,link:f?.link}),g=Math.floor(i/s),L=i%s;h.style.position="absolute",h.style.top=`${g*o}px`,h.style.left=`${L*l}px`,h.style.width=`${l}px`,h.style.height=`${o}px`,h.dataset.index=i.toString(),e.appendChild(h),C.add(i)}C.forEach(i=>{if(!a.has(i)){const f=e.querySelector(`[data-index='${i}']`);f&&e.removeChild(f),C.delete(i)}})}function Ie(){const e=x();if(!e)return;const{columns:t,rowHeight:n,itemWidth:s}=P();C.forEach(o=>{const l=e.querySelector(`[data-index='${o}']`);if(l){const r=Math.floor(o/t),a=o%t;l.style.top=`${r*n}px`,l.style.left=`${a*s}px`,l.style.width=`${s}px`,l.style.height=`${n}px`}})}function Ce(){We(C)}const A={LIGHT:"light",DARK:"dark"},u={GRID:"grid",COVERFLOW:"coverflow"};function ae(e,t){let n=null;return function(...s){n!==null&&clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}function ce(){const e=p();e===u.GRID?U():e===u.COVERFLOW&&he()}function Ae(){const e=p();e===u.GRID?Ce():e===u.COVERFLOW&&pe()}function H(){Ae(),p()===u.GRID&&O(K()),ce()}function _(){p()===u.GRID&&(ie(),O(K()),Ie(),U())}function Se(){const e=document.documentElement,t=document.querySelector("#themeBtn .material-symbols-rounded"),n=e.classList.toggle(A.DARK),s=n?A.DARK:A.LIGHT;t&&(t.textContent=n?"light_mode":"dark_mode"),localStorage.setItem("theme",s)}function Me(){const e=localStorage.getItem("theme"),t=document.documentElement,n=document.querySelector("#themeBtn .material-symbols-rounded");e===A.LIGHT?(t.classList.remove(A.DARK),n&&(n.textContent="dark_mode")):(t.classList.add(A.DARK),n&&(n.textContent="light_mode"))}function Re(e){const t=document.createElement("button");t.id=e.id,t.className="px-2 py-2 text-zinc-500 dark:text-zinc-400 dark:hover:text-white hover:text-black flex cursor-pointer hover:bg-white/30 dark:hover:bg-zinc-950/30 rounded-sm duration-300 ease-out"+(e.className?` ${e.className}`:"");const n=document.createElement("span");return n.className="material-symbols-rounded",n.textContent=e.icon,t.appendChild(n),t.addEventListener("click",e.handler),t}function ke(e){const t=document.getElementById("zoomInBtn"),n=document.getElementById("zoomOutBtn");if(!t||!n)return;const s=e===u.COVERFLOW,o=s?["w-0","opacity-0","collapse"]:["px-2"],l=s?["px-2"]:["w-0","opacity-0","collapse"];t.classList.add(...o),t.classList.remove(...l),n.classList.add(...o),n.classList.remove(...l),s?(t.classList.add("-translate-x-full"),n.classList.add("translate-x-full")):(t.classList.remove("-translate-x-full"),n.classList.remove("translate-x-full"))}function ze(){const e=document.getElementById("controlsContainer");if(!e)return;const t=[{id:"shuffleBtn",icon:"shuffle",className:"controls--shuffle",handler:()=>{te(),H()}},{id:"zoomOutBtn",icon:"zoom_out",handler:()=>{p()===u.GRID&&xe()&&_()}},{id:"zoomInBtn",icon:"zoom_in",handler:()=>{p()===u.GRID&&we()&&_()}},{id:"viewToggleBtn",icon:"view_carousel",handler:()=>{const o=p()===u.GRID?u.COVERFLOW:u.GRID;Le(o);const l=document.querySelector("#viewToggleBtn .material-symbols-rounded");l&&(l.textContent=o===u.GRID?"view_carousel":"grid_view"),ke(o),H(),o===u.COVERFLOW&&$()}},{id:"themeBtn",icon:"light_mode",handler:Se}],n=document.createDocumentFragment();t.forEach(s=>n.appendChild(Re(s))),e.appendChild(n),Me()}function Te(e){const t=document.getElementById("searchInput"),n=document.querySelector(".arrow-back");!t||!n||(e?(n.classList.remove("invisible","-translate-x-2"),n.classList.add("visible","translate-x-0"),t.classList.remove("-translate-x-9")):(n.classList.remove("visible","translate-x-0"),n.classList.add("invisible","-translate-x-2"),t.classList.add("-translate-x-9")))}function $e(){const e=document.getElementById("grid"),t=document.querySelector(".scrim");if(!e||!t)return;const n=(s,o)=>{const r=s.target.closest(".album-card");p()===u.GRID&&r&&(t.classList.toggle("opacity-0",!o),t.classList.toggle("opacity-70",o),r.classList.toggle("z-50",o))};e.addEventListener("mouseover",s=>n(s,!0)),e.addEventListener("mouseout",s=>n(s,!1))}function Oe(){let e=!1;window.addEventListener("scroll",()=>{p()===u.GRID&&!e&&(window.requestAnimationFrame(()=>{U(),e=!1}),e=!0)});let t=!1;x()?.addEventListener("scroll",()=>{p()===u.COVERFLOW&&!t&&(window.requestAnimationFrame(()=>{$(),t=!1}),t=!0)})}function De(){const e=document.getElementById("searchInput");if(!e)return;const t=ae(n=>{fe(n),H(),Te(n.length>0)},200);e.addEventListener("input",n=>{t(n.target.value)}),document.querySelector(".arrow-back")?.addEventListener("click",()=>{e.value="",t("")}),window.addEventListener("keydown",n=>{const s=document.activeElement,o=s===e,l=s&&["INPUT","TEXTAREA","SELECT"].includes(s.tagName)&&!o;if(n.ctrlKey||n.altKey||n.metaKey||l)return;const r=n.key.length===1,a=n.key==="Backspace";!o&&(r||a)&&(n.preventDefault(),e.focus(),a?e.value=e.value.slice(0,-1):e.value+=n.key,t(e.value))})}function Be(){$e(),window.addEventListener("resize",ae(_,200)),Oe(),De()}function We(e){const t=x();if(!t)return;Array.from(t.children).forEach(s=>{s.style.height!=="1px"&&t.removeChild(s)}),p()!=="coverflow"&&(t.innerHTML=""),e.clear()}function qe(){document.addEventListener("DOMContentLoaded",async()=>{ye(),await ue(),te(),O(K()),ce(),ze(),Be()})}qe();
